if (self.CavalryLogger) { CavalryLogger.start_js(["ManXl"]); }

__d("PlacesSaveButton.react",["ix","cx","fbt","AsyncRequest","Image.react","MenuSeparator.react","MenuStaticItem.react","PlacesSearchClickTypeEnums.react","PlacesSearchResults.react","PopoverMenu.react","React","ReactXUIMenu","SavedListStateActions","SimpleXUIDialog","XSaveAddToSaveListController","XSaveController","XSaveListCreateDialogController","XSavedListsFromSaverController","XUIButton.react","XUIPopoverButton.react","XUISpinner.react","fbglyph"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k=b("ReactXUIMenu").Item;c=babelHelpers.inherits(a,b("React").Component);j=c&&c.prototype;function a(a,b){j.constructor.call(this,a,b),this.state={isLoading:!1,saveState:this.props.actionInfo.saveState==="SAVED"?"saved":"save",savedListMap:new Map()}}a.prototype.render=function(){if(this.props.savedListsGk)return this.$1();else return this.$2()};a.prototype.$2=function(){var a=this.props.withoutLabel?"":this.state.saveState==="saved"?i._("Saved"):i._("Save"),c=this.props.withoutLabel?"_w0u":"_44h8",d=this.state.saveState==="saved"?g("136872"):g("125658"),e=this.state.saveState==="saving"||this.state.saveState==="unsaving",f=this.state.saveState==="saved"?"saved":"save",h=this.state.saveState==="saved"?b("PlacesSearchClickTypeEnums.react").SAVED:b("PlacesSearchClickTypeEnums.react").SAVE;return b("React").createElement(b("XUIButton.react"),babelHelpers["extends"]({className:c,size:this.props.size,"data-et":JSON.stringify({click_point:f,data:JSON.stringify({entity_id:this.props.entityID})})},b("PlacesSearchResults.react").getLoggingData({resultID:this.props.entityID,clickType:h}),{label:a,disabled:e,image:b("React").createElement(b("Image.react"),{src:d}),onClick:function(){return this.$3()}.bind(this)}))};a.prototype.$1=function(){return this.state.saveState==="save"||this.state.saveState==="saving"?this.$2():this.$4()};a.prototype.$5=function(event){var a=event.target.getAttribute("name");new(b("AsyncRequest"))().setURI(b("XSaveAddToSaveListController").getURIBuilder().getURI()).setData({object_id:this.props.entityID,list_id:event.target.getAttribute("value")}).setHandler(function(c){c=c.getPayload().response;c===b("SavedListStateActions").SAVED_IN_LIST?b("SimpleXUIDialog").show(b("React").createElement("div",null,i._("Successfully added to list"),'\xa0"',a,'"')):c===b("SavedListStateActions").SAVE_ALREADY_IN_LIST?b("SimpleXUIDialog").show(b("React").createElement("div",null,i._("Already in list"),'\xa0"',a,'"')):b("SimpleXUIDialog").show(b("React").createElement("div",null,i._("Something went wrong, please try again.")))}).send()};a.prototype.$6=function(){return!this.state.isLoading?null:b("React").createElement(k,null,b("React").createElement(b("XUISpinner.react"),{size:"small"}))};a.prototype.$7=function(){__p&&__p();if(this.state.savedListMap===null||this.state.isLoading)return null;var a=[],c=this.state.savedListMap;for(var d in c){var e=c[d].name,f=c[d].icon,h=null;c[d].inList&&(h=b("React").createElement(b("Image.react"),{className:"_4jse",src:g("128986")}));a.push(b("React").createElement(k,{key:d},b("React").createElement("div",{className:"_4jsf",name:e,onClick:function(event){return this.$5(event)}.bind(this),role:"presentation",value:d},h,b("React").createElement("span",{value:d,name:e},b("React").createElement(b("Image.react"),{src:f}),e))))}return a};a.prototype.$8=function(){if(this.state.isLoading)return null;if(Object.keys(this.state.savedListMap).length===0)return b("React").createElement(b("MenuStaticItem.react"),null,i._("You have no saved lists yet."));else return b("React").createElement(b("MenuStaticItem.react"),null,i._("Add to..."))};a.prototype.$4=function(){var a=this.state.saveState==="unsaving",c=b("React").createElement(b("ReactXUIMenu"),null,this.$8(),this.$6(),this.$7(),b("React").createElement(b("MenuSeparator.react"),null),b("React").createElement(k,{onclick:function(event){return this.$9(event)}.bind(this)},i._("Add to new list...")),b("React").createElement(b("MenuSeparator.react"),null),b("React").createElement(k,{onclick:function(event){return this.$3(event)}.bind(this)},i._("Unsave")));return b("React").createElement("div",null,b("React").createElement(b("PopoverMenu.react"),{menu:c,disabled:a},this.$10()))};a.prototype.$10=function(){var a=this.props.withoutLabel?"":i._("Saved"),c=this.props.withoutLabel?"_w0u":"_44h8",d=g("136872"),e=this.state.saveState==="unsaving";return b("React").createElement(b("XUIPopoverButton.react"),babelHelpers["extends"]({className:c,size:this.props.size,"data-et":JSON.stringify({click_point:"saved",data:JSON.stringify({entity_id:this.props.entityID})})},b("PlacesSearchResults.react").getLoggingData({resultID:this.props.entityID,clickType:b("PlacesSearchClickTypeEnums.react").SAVED}),{label:a,disabled:e,image:b("React").createElement(b("Image.react"),{src:d}),onClick:function(){return this.$11()}.bind(this)}))};a.prototype.$3=function(){var a=this.state.saveState;this.setState({saveState:this.$12()});new(b("AsyncRequest"))().setURI(b("XSaveController").getURIBuilder().getURI()).setData({object_id:this.props.entityID,action:a==="saved"?"UNSAVE":"SAVE",surface:"search",mechanism:"search_result"}).setHandler(function(b){this.setState({saveState:b.error===0?this.$12():a})}.bind(this)).send()};a.prototype.$12=function(){if(this.state.saveState==="save")return"saving";if(this.state.saveState==="saving")return"saved";return this.state.saveState==="saved"?"unsaving":"save"};a.prototype.$11=function(){this.setState({isLoading:!0}),new(b("AsyncRequest"))().setURI(b("XSavedListsFromSaverController").getURIBuilder().getURI()).setData({object_id:this.props.entityID}).setHandler(function(a){this.setState({savedListMap:a.payload.savedListMap,isLoading:!1})}.bind(this)).send()};a.prototype.$9=function(){new(b("AsyncRequest"))().setURI(b("XSaveListCreateDialogController").getURIBuilder().getURI()).setData({object_id:this.props.entityID}).send()};e.exports=a}),null);