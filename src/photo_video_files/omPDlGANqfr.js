if (self.CavalryLogger) { CavalryLogger.start_js(["R19zr"]); }

__d("LiveVideoControlPanelFunnelLogger",["FunnelLogger"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g="FACECAST_BROADCASTER_FUNNEL";a=!1;var h={startFromControlPanel:function(){h._startInternal("CONTROL_PANEL")},fetchedBroadcastID:function(a){b("FunnelLogger").appendAction(g,"fetched_broadcast_id"),b("FunnelLogger").addFunnelTag(g,"broadcast_id:"+a)},endWithFailedBroadcastID:function(){b("FunnelLogger").appendAction(g,"failed.broadcast_id"),b("FunnelLogger").appendAction(g,"failed"),h.end()},goLiveClicked:function(){b("FunnelLogger").appendAction(g,"go_live_clicked")},previewButtonClicked:function(){b("FunnelLogger").appendAction(g,"preview_button_clicked")},previewStarted:function(){b("FunnelLogger").appendAction(g,"preview_stream_started")},finishClicked:function(){b("FunnelLogger").appendAction(g,"finish_clicked")},endCopyrightViolation:function(){b("FunnelLogger").appendAction(g,"failed.copyright_violation"),b("FunnelLogger").appendAction(g,"failed"),h.end()},end:function(){b("FunnelLogger").endFunnel(g)},_startInternal:function(a){b("FunnelLogger").startFunnel(g),b("FunnelLogger").setFunnelTimeout(g,86400),b("FunnelLogger").addFunnelTag(g,"source:"+a)}};e.exports=h}),null);
__d("LiveControlPanelUtils",["AsyncRequest","ComposerEntryPointRef","LiveVideoBroadcastActions","LiveVideoBroadcastConstants","LiveVideoControlPanelFunnelLogger","XLiveVideoBroadcastLaunchComposerController"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("LiveVideoBroadcastConstants").INPUT_SOURCE;function a(a,c){c=c?g.CAMERA:g.API;b("LiveVideoBroadcastActions").setDialogLoading(!0);c=b("XLiveVideoBroadcastLaunchComposerController").getURIBuilder().setString("default_input_source",c).setString("composer_entry_point",b("ComposerEntryPointRef").LIVE_CONTROL_PANEL);a&&c.setFBID("page_id",a);a=c.getURI();new(b("AsyncRequest"))().setURI(a).send();b("LiveVideoControlPanelFunnelLogger").startFromControlPanel()}c={openDialog:a};e.exports=c}),null);
__d("LiveControlPanelUnifiedCreateButton.react",["cx","fbt","LiveControlPanelUtils","React","XUIButton.react","XUISpinner.react"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;i=babelHelpers.inherits(a,b("React").Component);i&&i.prototype;a.prototype.render=function(){return this.props.isDialogLoading?b("React").createElement("div",{className:"_5o4o"},b("React").createElement(b("XUIButton.react"),{disabled:!0,image:b("React").createElement(b("XUISpinner.react"),null),label:h._("Loading"),size:"xlarge"})):b("React").createElement("div",{className:"_5o4o"},b("React").createElement(b("XUIButton.react"),{label:h._("Create Live Stream"),size:"xlarge",use:"confirm",onClick:this.$1}))};a.prototype.$1=function(){b("LiveControlPanelUtils").openDialog()};function a(){i.apply(this,arguments)}e.exports=a}),null);
__d("LiveVideoBroadcastAPIActions",["LiveVideoBroadcastDispatcher"],(function(a,b,c,d,e,f){__p&&__p();a={deleteAPIReplayVideo:function(){var a={type:"DELETE_API_REPLAY_VIDEO"};b("LiveVideoBroadcastDispatcher").dispatch(a)},apiBroadcastStopped:function(){var a={type:"API_BROADCAST_STOPPED"};b("LiveVideoBroadcastDispatcher").dispatch(a)},apiGoLiveClicked:function(){var a={type:"API_GO_LIVE_CLICKED"};b("LiveVideoBroadcastDispatcher").dispatch(a)},addInputStream:function(){var a={type:"ADD_INPUT_STREAM"};b("LiveVideoBroadcastDispatcher").dispatch(a)},setIs360Video:function(a){a={type:"SET_IS_360_VIDEO",value:a};b("LiveVideoBroadcastDispatcher").dispatch(a)},setIs360Audio:function(a){a={type:"SET_IS_360_AUDIO",value:a};b("LiveVideoBroadcastDispatcher").dispatch(a)},setIsSingleFisheye:function(a){a={type:"SET_IS_SINGLE_FISHEYE",value:a};b("LiveVideoBroadcastDispatcher").dispatch(a)},setSingleFisheyeFOV:function(a){a={type:"SET_SINGLE_FISHEYE_FOV",value:a};b("LiveVideoBroadcastDispatcher").dispatch(a)},update360Configuration:function(a){a={type:"UPDATE_360_CONFIGURATION",value:a};b("LiveVideoBroadcastDispatcher").dispatch(a)},setEmbeddable:function(a){a={type:"SET_EMBEDDABLE",value:a};b("LiveVideoBroadcastDispatcher").dispatch(a)},setShouldExpireAfterGoLive:function(a){a={type:"SET_SHOULD_EXPIRE_AFTER_GO_LIVE",value:a};b("LiveVideoBroadcastDispatcher").dispatch(a)},setContinuous:function(a){a={type:"SET_CONTINUOUS",value:a};b("LiveVideoBroadcastDispatcher").dispatch(a)},setShouldShowGraphicContentWarning:function(a){a={type:"SET_SHOULD_SHOW_GRAPHIC_CONTENT_WARNING",value:a};b("LiveVideoBroadcastDispatcher").dispatch(a)},setCopyrighted:function(a){a={type:"SET_COPYRIGHTED",value:a};b("LiveVideoBroadcastDispatcher").dispatch(a)},setCopyrightMonitoringType:function(a){a={type:"SET_COPYRIGHT_MONITORING_TYPE",value:a};b("LiveVideoBroadcastDispatcher").dispatch(a)},setCopyrightContentCategory:function(a){a={type:"SET_COPYRIGHT_CONTENT_CATEGORY",value:a};b("LiveVideoBroadcastDispatcher").dispatch(a)},setCopyrightOwnershipCountries:function(a,c){a={type:"SET_COPYRIGHT_OWNERSHIP_COUNTRIES",ownershipCountries:a,areCountriesIncluded:c};b("LiveVideoBroadcastDispatcher").dispatch(a)},setCopyrightRuleID:function(a){a={type:"SET_COPYRIGHT_RULE_ID",value:a};b("LiveVideoBroadcastDispatcher").dispatch(a)},updateCopyrightWhitelistedFBUsers:function(a){a={type:"UPDATE_COPYRIGHT_WHITELISTED_FB_USERS",value:a};b("LiveVideoBroadcastDispatcher").dispatch(a)},updateCopyrightWhitelistedIGUserNames:function(a){a={type:"UPDATE_COPYRIGHT_WHITELISTED_IG_USERNAMES",value:a};b("LiveVideoBroadcastDispatcher").dispatch(a)},updateBackupInputStream:function(a,c){a={type:"UPDATE_BACKUP_INPUT_STREAM",backupStreamURL:a,backupSecureStreamURL:c};b("LiveVideoBroadcastDispatcher").dispatch(a)},broadcastErrorReceived:function(){var a={type:"BROADCAST_ERROR_RECEIVED"};b("LiveVideoBroadcastDispatcher").dispatch(a)},errorStartingAPIBroadcast:function(a,c){a={type:"ERROR_STARTING_API_BROADCAST",errorType:a,additionalInfo:c};b("LiveVideoBroadcastDispatcher").dispatch(a)},setSelectedEncoderType:function(a){a={type:"SET_SELECTED_ENCODER_TYPE",encoderType:a};b("LiveVideoBroadcastDispatcher").dispatch(a)},setSelectedEncoderName:function(a){a={type:"SET_SELECTED_ENCODER_NAME",encoderName:a};b("LiveVideoBroadcastDispatcher").dispatch(a)}};e.exports=a}),null);
__d("VideoBroadcastTypeType",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({REGULAR:0,AMBIENT:1})}),null);
__d("XLiveComposerPrivacySelectorController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/live/broadcast/audienceSelector/",{video_id:{type:"FBID"},target_id:{type:"FBID"}})}),null);
__d("XLiveVideoBroadcastHandleScheduledLiveController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/video_broadcast/handle_schedule/",{broadcast_id:{type:"FBID"},schedule_custom_profile_image_focus:{type:"StringToFloatMap"},schedule_feed_background_image_focus:{type:"StringToFloatMap"},planned_start_time:{type:"Int"},enable_manual_mode:{type:"Bool",defaultValue:!1}})}),null);
__d("LiveVideoBroadcastAPIBroadcastStore",["fbt","ActorURI","Arbiter","AsyncRequest","AsyncUploadRequest","Bootloader","ErrorDialog","FluxMapStore","GraphAPI","GraphLiveVideoNodeParam","LiveVideoBroadcastActions","LiveVideoBroadcastAPIActions","LiveVideoBroadcastBroadcastStore","LiveVideoBroadcastConstants","LiveVideoBroadcastDispatcher","LiveVideoBroadcastIDStore","LiveVideoBroadcastUIStore","LiveVideoBroadcastUtils","RTISubscriptionManager","VideoBroadcastTypeType","VideoProjection","XLiveComposerPrivacySelectorController","XLiveVideoBroadcastHandleScheduledLiveController","immutable","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i=b("LiveVideoBroadcastConstants").ACTIONS,j=b("LiveVideoBroadcastConstants").ENCODER_TYPE,k=b("LiveVideoBroadcastConstants").INPUT_SOURCE;h=babelHelpers.inherits(a,b("FluxMapStore"));h&&h.prototype;a.prototype.getInitialState=function(){return b("immutable").Map({apiLivePreviewPlaying:!1,areCountriesIncluded:!1,copyrightWhitelistedFBUsers:[],copyrightWhitelistedIGUserNames:[],errorCount:null,is360Video:!1,is360Audio:!1,isContentProtectionEnabled:!1,isSingleFisheye:!1,singleFisheyeFOV:0,sphericalConfigSelectorValue:null,isContinuous:!1,isCopyrighted:!1,isEmbeddable:!0,isScheduledManualMode:!1,isUpdateRequestPending:!1,ownershipCountries:[],scheduleStartTime:null,shouldExpireAfterGoLive:!1,shouldShowGraphicContentWarning:!1,usePersistenStreamKeyByDefault:null})};a.prototype.reduce=function(a,c){__p&&__p();switch(c.type){case i.START_BROADCAST_SUCCESS:b("Arbiter").inform("BroadcastDialog/liveStarted",{broadcastID:this.get("apiBroadcastID")});break;case i.CLEANUP:a=this.getInitialState();break;case i.API_BROADCAST_CREATED:a=a.set("apiBroadcastID",c.id);a=a.set("apiStreamURL",c.streamURL);a=a.set("apiBackupStreamURL",c.backupStreamURL);a=a.set("apiSecureStreamURL",c.secureStreamURL);a=a.set("apiVideoID",c.videoID);a=a.set("apiEmbedHTML",c.apiEmbedHTML);a=a.set("apiLivePreviewPlaying",!1);a=a.set("errorCount",0);a=a.set("attributionAppID",c.attributionAppID);a=a.set("apiBackupSecureStreamURL",c.backupSecureStreamURL);this.$LiveVideoBroadcastAPIBroadcastStore2(c.id);this.$LiveVideoBroadcastAPIBroadcastStore3(c.actorID,c.videoID,c.targetID);break;case i.BROADCAST_ERROR_RECEIVED:a=a.set("errorCount",this.get("errorCount")+1);break;case i.API_BROADCAST_LIVE_PREVIEW_PLAYING:a=a.set("apiLivePreviewPlaying",c.livePreviewPlaying);break;case i.ADD_INPUT_STREAM:var d=b("LiveVideoBroadcastUIStore").getState().toObject();d=d.accessToken;d=b("LiveVideoBroadcastUtils").createInputStream(d,a.get("apiBroadcastID"));b("promiseDone")(d,function(a){b("LiveVideoBroadcastAPIActions").updateBackupInputStream(a.stream_url,a.secure_stream_url)});break;case i.FINISH_BROADCAST_REQUEST:this.$LiveVideoBroadcastAPIBroadcastStore4();break;case i.DELETE_API_REPLAY_VIDEO:this.$LiveVideoBroadcastAPIBroadcastStore5();break;case i.SET_API_BROADCAST_PRIVACY_SELECTOR:a=a.set("apiComposerPrivacySelector",c.apiComposerPrivacySelector);break;case i.SET_TARGET:case i.CLEAR_API_BROADCAST_ID:a=a.set("apiBroadcastID",null);a=a.set("apiLivePreviewPlaying",!1);a=a.set("errorCount",0);a=a.set("usePersistenStreamKeyByDefault",null);a=a.set("isContentProtectionEnabled",!1);break;case i.SET_CONTENT_PROTECTION_ENABLED:a=a.set("isContentProtectionEnabled",c.enabled);a=a.set("apiBroadcastID",null);break;case i.SET_IS_360_VIDEO:a=a.set("is360Video",c.value);a=a.set("is360Audio",!1);a=a.set("isSingleFisheye",!1);a=a.set("singleFisheyeFOV",180);a=a.set("sphericalConfigSelectorValue",null);a=a.set("apiBroadcastID",null);break;case i.SET_IS_360_AUDIO:a=a.set("is360Audio",c.value);c.value&&(a=a.set("isSingleFisheye",!1));a=a.set("apiBroadcastID",null);break;case i.SET_SCHEDULED_LIVE_DATA:c.isManualMode!=null&&(a=a.set("isScheduledManualMode",c.isManualMode));c.scheduleStartTime!=null&&(a=a.set("scheduleStartTime",c.scheduleStartTime));break;case i.SET_IS_SINGLE_FISHEYE:a=a.set("isSingleFisheye",c.value);a=a.set("singleFisheyeFOV",180);c.value&&(a=a.set("is360Audio",!1));a=a.set("apiBroadcastID",null);break;case i.SET_SINGLE_FISHEYE_FOV:a=a.set("singleFisheyeFOV",c.value);a=a.set("apiBroadcastID",null);break;case i.UPDATE_360_CONFIGURATION:a=a.set("sphericalConfigSelectorValue",c.value);c.value&&c.value.getAuxiliaryData().projection===b("VideoProjection").SINGLE_FISH_EYE&&(a=a.set("singleFisheyeFOV",180),a=a.set("is360Audio",!1));a=a.set("apiBroadcastID",null);break;case i.SET_EMBEDDABLE:a=a.set("isEmbeddable",c.value);break;case i.SCHEDULED_LIVE_REQUEST:this.$LiveVideoBroadcastAPIBroadcastStore6(c.actorID,c.broadcastID,c.plannedStartTime,c.customProfileImage,c.customProfileImageFocus,c.feedBackgroundImage,c.feedBackgroundFocus,c.customAnnouncementThumbnail,c.enableManualMode);break;case i.SET_SHOULD_EXPIRE_AFTER_GO_LIVE:a=a.set("shouldExpireAfterGoLive",c.value);break;case i.SET_SHOULD_SHOW_GRAPHIC_CONTENT_WARNING:a=a.set("shouldShowGraphicContentWarning",c.value);break;case i.SET_CONTINUOUS:a=a.set("isContinuous",c.value);break;case i.SET_COPYRIGHTED:a=a.set("isCopyrighted",c.value);break;case i.SET_COPYRIGHT_MONITORING_TYPE:a=a.set("copyrightMonitoringType",c.value);break;case i.SET_COPYRIGHT_CONTENT_CATEGORY:a=a.set("selectedCategory",c.value);break;case i.SET_COPYRIGHT_OWNERSHIP_COUNTRIES:a=a.set("areCountriesIncluded",c.areCountriesIncluded);a=a.set("ownershipCountries",c.ownershipCountries);break;case i.SET_COPYRIGHT_RULE_ID:a=a.set("copyrightRuleID",c.value);break;case i.UPDATE_COPYRIGHT_WHITELISTED_FB_USERS:a=a.set("copyrightWhitelistedFBUsers",c.value);break;case i.UPDATE_COPYRIGHT_WHITELISTED_IG_USERNAMES:a=a.set("copyrightWhitelistedIGUserNames",c.value);break;case i.UPDATE_BACKUP_INPUT_STREAM:a=a.set("apiBackupStreamURL",c.backupStreamURL);a=a.set("apiBackupSecureStreamURL",c.backupSecureStreamURL);break;case i.API_GO_LIVE_CLICKED:a=a.set("isUpdateRequestPending",!0);break;case i.ERROR_STARTING_API_BROADCAST:a=a.set("isUpdateRequestPending",!1);break;case i.UPDATE_UI_CONFIG:c.values.usePersistenStreamKeyByDefault!=undefined&&(a=a.set("usePersistenStreamKeyByDefault",c.values.usePersistenStreamKeyByDefault));c.values.broadcastType!=undefined&&(a=a.set("isContinuous",c.values.broadcastType===b("VideoBroadcastTypeType").AMBIENT));c.values.shouldExpireAfterGoLive!=undefined&&(a=a.set("shouldExpireAfterGoLive",c.values.shouldExpireAfterGoLive));c.values.shouldShowGraphicContentWarning!=undefined&&(a=a.set("shouldShowGraphicContentWarning",c.values.shouldShowGraphicContentWarning));c.values.isEmbeddable!=undefined&&(a=a.set("isEmbeddable",c.values.isEmbeddable));break;case i.SET_SELECTED_ENCODER_TYPE:if(c.encoderType===j.STREAM_KEY){d=b("LiveVideoBroadcastUIStore").getState().toObject();c=d.accessToken;b("GraphAPI")("2.8").object("live_video",a.get("apiBroadcastID")).post({access_token:c,live_encoders:[null]})}break;default:break}return a};a.prototype.$LiveVideoBroadcastAPIBroadcastStore2=function(a){this.$LiveVideoBroadcastAPIBroadcastStore1&&this.$LiveVideoBroadcastAPIBroadcastStore1.unsubscribe(),this.$LiveVideoBroadcastAPIBroadcastStore1=b("RTISubscriptionManager").subscribe("video/broadcast/error/"+a,function(){return b("LiveVideoBroadcastAPIActions").broadcastErrorReceived()})};a.prototype.$LiveVideoBroadcastAPIBroadcastStore6=function(a,c,d,e,f,g,h,i,j){var k=b("XLiveVideoBroadcastHandleScheduledLiveController").getURIBuilder().getURI();k=b("ActorURI").create(k,a);a=new(b("AsyncUploadRequest"))(k).setAllowCrossOrigin(!1).setData({broadcast_id:c,enable_manual_mode:!!j,planned_start_time:d,schedule_custom_profile_image_focus:f,schedule_feed_background_image_focus:h}).setFiles({schedule_custom_profile_image:e,schedule_custom_background_image:i,schedule_feed_background_image:g});a.subscribe("failure",function(a,c){b("LiveVideoBroadcastActions").scheduledLiveFail(c&&c.$LiveVideoBroadcastAPIBroadcastStore7)});a.subscribe("complete",function(){j?(b("LiveVideoBroadcastActions").setScheduledLiveData(!0,null),b("LiveVideoBroadcastActions").scheduledLiveSuccess(!1)):b("LiveVideoBroadcastActions").scheduledLiveSuccess(!0)});a.send()};a.prototype.$LiveVideoBroadcastAPIBroadcastStore3=function(a,c,d){var e=b("XLiveComposerPrivacySelectorController").getURIBuilder();e=b("ActorURI").create(e.getURI(),a);new(b("AsyncRequest"))().setURI(e).setData({video_id:c,target_id:d}).setMethod("POST").send()};a.prototype.$LiveVideoBroadcastAPIBroadcastStore4=function(){var a=b("LiveVideoBroadcastUIStore").getState().toObject();a=a.inputSource;if(a===k.CAMERA)return;b("LiveVideoBroadcastIDStore").get("broadcastID");b("Bootloader").loadModules(["ModernLiveVideoEndMutation","RelayFBEnvironment"],function(a,c){a.commit(c,{videoID:b("LiveVideoBroadcastIDStore").get("videoID")},{onCompleted:function(){b("LiveVideoBroadcastActions").finishBroadcastSuccess()},onError:function(a){b("LiveVideoBroadcastActions").errorEndBroadcastMutationFail(a),b("ErrorDialog").show(g._("End broadcast error"),g._("Error ending broadcast, please try again"))}})},"LiveVideoBroadcastAPIBroadcastStore")};a.prototype.$LiveVideoBroadcastAPIBroadcastStore5=function(){var a=this.get("apiVideoID");a&&b("LiveVideoBroadcastBroadcastStore").deleteVideo(a)};function a(){h.apply(this,arguments)}a.__moduleID=e.id;e.exports=new a(b("LiveVideoBroadcastDispatcher"))}),null);
__d("XLiveVideoUpdateBroadcastController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/video_broadcast/update/",{broadcast_id:{type:"FBID"},description:{type:"String"},privacyx:{type:"String"},political_district:{type:"String"},targeted_privacy_data:{type:"HackType"},title:{type:"String"},planned_start_time:{type:"Int"},is_continuous:{type:"Bool",defaultValue:!1},is_episode:{type:"Bool",defaultValue:!1},season_id:{type:"FBID"},playlist_ids:{type:"FBIDVector"},crosspost_page_ids:{type:"FBIDVector"},breaking_news_expiration:{type:"Int"},attached_trivia_game_id:{type:"FBID"}})}),null);
__d("LiveVideoBroadcastAfterBootloadUtils",["fbt","ActorURI","AsyncRequest","ComposerVideoPostUtils","ErrorDialog","LiveVideoBroadcastActions","LiveVideoBroadcastAPIActions","LiveVideoBroadcastUtils","ShareDialogAudienceTypes","VideoCopyrightAPI","XLiveVideoUpdateBroadcastController","expectationViolation","nullthrows","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();function a(a,c){var d="",e;d;a.audience==b("ShareDialogAudienceTypes").PAGE?(d=a.audienceTargets[0].actorId,e=a.audienceTargets[0].pageId):a.audience==b("ShareDialogAudienceTypes").OWN?(d=c||"",e=c||""):(d=a.actorId?a.actorId:"",e=a.audienceTargets[0]||d);return{actorID:d,targetID:e}}function c(){b("ErrorDialog").show(g._("Broadcast error"),g._("Error starting broadcast, please try again"))}function h(a){__p&&__p();var c={};if(a.selectedAttributionTag){var d=b("ComposerVideoPostUtils").getAttributionTagID(a.selectedAttributionTag);c=babelHelpers["extends"]({},c,{app_attribution_tag:d})}if(a.selectedGame){d=b("ComposerVideoPostUtils").getGameID(a.selectedGame);c=babelHelpers["extends"]({},c,{game_id:d})}if(a.selectedGroups){d=b("ComposerVideoPostUtils").getGroupIDs(a.selectedGroups);c=babelHelpers["extends"]({},c,{crossshare_group_ids:d})}if(a.videoTJApp){d=b("ComposerVideoPostUtils").getVideoTJAppID(a.videoTJApp);c=babelHelpers["extends"]({},c,{video_tj_app_id:d})}a.videoTitle&&(c=babelHelpers["extends"]({},c,{title:a.videoTitle}));if(a.contentTags){d=a.contentTags.map(function(a){return a.getUniqueID()});c=babelHelpers["extends"]({},c,{content_tags:d})}a.attachedTriviaGameID&&(c=babelHelpers["extends"]({},c,{attached_trivia_game_id:a.attachedTriviaGameID}));return c}function d(a,c,d,e,f,g,j,k,l,m,n,o,p){var q=h(l),r=b("LiveVideoBroadcastUtils").getComposerFormData(f.contextConfig.composerID,f.config.targetData.targetID,f.config.contextInfo,p);!k?i(c,e,m,r,q,n,o):b("promiseDone")(b("VideoCopyrightAPI").copyrightVideo(a,b("nullthrows")(j),d,g,"live_video_composer"),function(a){i(c,e,m,r,q,n,o)},function(a){b("LiveVideoBroadcastAPIActions").errorStartingAPIBroadcast("copyright call",a)})}function i(a,c,d,e,f,g,h){c||b("expectationViolation")("cannot update broadcast without a broadcastiD");c=b("XLiveVideoUpdateBroadcastController").getURIBuilder().setFBID("broadcast_id",c).getURI();if(!a){b("expectationViolation")("cannot start broadcast without an actorID");return}c=b("ActorURI").create(c,a);new(b("AsyncRequest"))(c).setData(babelHelpers["extends"]({},d,e,f)).setHandler(g).setErrorHandler(function(a){h(),b("LiveVideoBroadcastActions").serverError(a)}).send()}f={getIDsFromTarget:a,showErrorDialog:c,updateBroadcastRequest:d,getUpdateMetadata:h,sendUpdateRequest:i};e.exports=f}),null);
__d("LiveVideoBroadcastCopyrightUtils",["LiveVideoBroadcastActions","RTISubscriptionManager"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=[];a={handleCopyrightEvent:function(event,a){a&&b("LiveVideoBroadcastActions").handleCopyrightEvent(event,a)},endLiveBroadcastWithCopyrightViolation:function(){b("LiveVideoBroadcastActions").setBroadcastEndedWithCopyrightViolation(),b("LiveVideoBroadcastActions").finishBroadcastRequest()},subscribeToCopyrightEvents:function(a){a=b("RTISubscriptionManager").subscribe("live/www/copyright/"+a,function(a){a=JSON.parse(a.payload);b("LiveVideoBroadcastActions").setCopyrightTriggered(!0);b("LiveVideoBroadcastActions").setCopyrightsViolationDialogState(a.event)});g.push(a)},unsubscribeTokens:function(){for(var a=0;a<g.length;a++){var b=g[a];b.unsubscribe()}}};e.exports=a}),null);
__d("XLiveVideoBroadcastReplayController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/live/broadcast/replay/",{video_id:{type:"FBID",required:!0}})}),null);
__d("XLiveVideoCheckIsPublishedController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/live_video/check_is_published/",{broadcast_id:{type:"FBID",required:!0},end_if_unpublished:{type:"Bool",defaultValue:!1}})}),null);
__d("XLiveVideoInitCommentsController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/live_video/init_comments/",{broadcast_id:{type:"FBID",required:!0},target_id:{type:"FBID",required:!0}})}),null);
__d("XLiveVideoPublishBroadcastController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/live_video/publish/",{broadcast_id:{type:"FBID"},description:{type:"String"}})}),null);
__d("LiveVideoBroadcastBroadcastStore",["fbt","CollabRTCChromeScreenSharingExtension","Bootloader","ErrorDialog","LiveVideoBroadcastActions","LiveVideoBroadcastConstants","ActorURI","AsyncRequest","LiveVideoBroadcastDispatcher","FBRTCHangupReason","FluxMapStore","immutable","LiveVideoBroadcastAPIBroadcastStore","LiveVideoBroadcastAfterBootloadUtils","LiveVideoBroadcastCopyrightUtils","LiveVideoBroadcastIDStore","LiveVideoBroadcastUIStore","LiveVideoBroadcastUtils","MediaRecorder","MediaRequestSourceApp","RTCCallActions","RTCCallStore","RTCMWProtocolHandler","RTCUtils","UFILiveStreamingComments","VideoProjection","VideoStereoFormat","XLiveVideoBroadcastReplayController","XLiveVideoCheckIsPublishedController","XLiveVideoCreateBroadcastController","XLiveVideoFinishBroadcastController","XLiveVideoInitCommentsController","XLiveVideoPublishBroadcastController","setTimeout"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;b("CollabRTCChromeScreenSharingExtension");var i=b("LiveVideoBroadcastConstants").ACTIONS,j=b("LiveVideoBroadcastConstants").BROADCAST_STATE,k=b("LiveVideoBroadcastConstants").CAMERA_DIMENSIONS,l=b("LiveVideoBroadcastConstants").CAMERA_STATE,m=b("LiveVideoBroadcastConstants").INPUT_SOURCE,n=273465416184080,o=2e3;c=babelHelpers.inherits(a,b("FluxMapStore"));h=c&&c.prototype;function a(){var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=h.constructor).call.apply(a,[this].concat(d)),this.$LiveVideoBroadcastBroadcastStore4=!1,b}a.prototype.getInitialState=function(){return b("immutable").Map({recordedChunks:[]})};a.prototype.reduce=function(a,c){__p&&__p();switch(c.type){case i.INITIALIZE:a=this.saveProps(a,c.value);break;case i.START_BROADCAST_REQUEST:a=a.set("broadcastStartTime",Date.now());var d=this.startBroadcast(c.value);a=a.set("recorder",d);break;case i.START_BROADCAST_SUCCESS:this.$LiveVideoBroadcastBroadcastStore5();this.$LiveVideoBroadcastBroadcastStore6();break;case i.REQUEST_UFI:this.$LiveVideoBroadcastBroadcastStore5();break;case i.ATTEMPT_RECONNECTION:d=this.get("maxFailureRetries")||0;var e=this.get("failureRetries")||0;this.attemptReconnection(e,d);a=a.set("failureRetries",e+1);break;case i.WEBRTC_CONNECTION_ESTABLISHED:a=a.set("failureRetries",0);break;case i.FINISH_BROADCAST_REQUEST:this.finishBroadcast();break;case i.GET_WEBCAM_STREAM_URL_REQUEST:if(this.$LiveVideoBroadcastBroadcastStore4)break;d=c.config&&c.config.audioInput?c.config.audioInput:a.get("selectedAudioInput");e=c.config&&c.config.videoInput?c.config.videoInput:a.get("selectedVideoInput");var f=a.get("mediaStream");f&&b("RTCUtils").stopMediaStream(f);a=a.set("selectedAudioInput",d);a=a.set("selectedVideoInput",e);this.createWebcamStreamUrl(d,e);break;case i.GET_SCREEN_STREAM_URL_REQUEST:f=c.config&&c.config.audioInput?c.config.audioInput:a.get("selectedAudioInput");a=a.set("selectedAudioInput",f);this.$LiveVideoBroadcastBroadcastStore7(f);break;case i.SCHEDULED_LIVE_SUCCESS:if(!c.shouldCloseDialog)break;case i.CLEANUP:a=this.getInitialState();this.$LiveVideoBroadcastBroadcastStore8();this.$LiveVideoBroadcastBroadcastStore9();break;case i.SET_INPUT_SOURCE:this.$LiveVideoBroadcastBroadcastStore6();break;case i.GET_WEBCAM_STREAM_URL_SUCCESS:a=a.set("selectedVideoInputSource","CAMERA");a=a.set("mediaStream",c.value.mediaStream);break;case i.GET_SCREEN_STREAM_URL_SUCCESS:a=a.set("selectedVideoInputSource","SCREEN");a=a.set("mediaStream",c.value.mediaStream);break;case i.DELETE_REPLAY_VIDEO:this.$LiveVideoBroadcastBroadcastStore10();break;case i.PREPARE_THUMBNAIL_URI:this.prepareThumbnailUri();break;case i.SET_THUMBNAIL_URI:a=a.set("thumbnailUri",c.value);break;case i.SET_CONTENT_PROTECTION_ENABLED:this.$LiveVideoBroadcastBroadcastStore11();break;case i.ERROR_TIME_OUT_WAITING_FOR_PUBLISH:case i.ERROR_TRACK_ENDED:this.finishBroadcast();break;case i.SET_TARGET:a=a.set("broadcastId",null);a=a.set("actorID",null);a=a.set("targetID",null);this.$LiveVideoBroadcastBroadcastStore12(a,c.value);break;case i.CLEAR_BROADCAST_ID:a=a.set("broadcastId",null);a=a.set("actorID",null);a=a.set("targetID",null);break;case i.SET_BROADCAST_ID:a=a.set("broadcastId",c.value);break;case i.SET_VIDEO_ID:a=a.set("videoId",c.value);break;case i.SET_IS_360_VIDEO:this.$LiveVideoBroadcastBroadcastStore11();break;case i.SET_IS_360_AUDIO:this.$LiveVideoBroadcastBroadcastStore11();break;case i.SET_IS_SINGLE_FISHEYE:this.$LiveVideoBroadcastBroadcastStore11();break;case i.SET_SINGLE_FISHEYE_FOV:this.$LiveVideoBroadcastBroadcastStore11();break;case i.UPDATE_360_CONFIGURATION:this.$LiveVideoBroadcastBroadcastStore11();break;case i.UPDATE_UI_CONFIG:c.values.broadcastId&&(a=a.set("broadcastId",c.values.broadcastId));c.values.videoId&&(a=a.set("videoId",c.values.videoId));c.values.viewerID&&(a=a.set("viewerID",c.values.viewerID));c.values.feedbackID&&(a=a.set("feedbackID",c.values.feedbackID));c.values.targetID&&(a=a.set("targetID",c.values.targetID));c.values.actorID&&(a=a.set("actorID",c.values.actorID));c.values.formData&&(a=a.set("formData",c.values.formData));c.values.streamSettings&&(a=a.set("streamSettings",c.values.streamSettings));c.values.maxFailureRetries&&(a=a.set("maxFailureRetries",c.values.maxFailureRetries));c.values.retryTimeoutSeconds&&(a=a.set("retryTimeoutSeconds",c.values.retryTimeoutSeconds));c.values.speedTestConfig&&(a=a.set("speedTestConfig",c.values.speedTestConfig));c.values.webRTCLoggingFreq&&(a=a.set("webRTCLoggingFreq",c.values.webRTCLoggingFreq));c.values.gks&&(a=a.set("vp8",c.values.gks.live_www_broadcasting_vp8_encoding));c.values.accountID&&(a=a.set("accountID",c.values.accountID));c.values.isCrosspost&&(a=a.set("isCrosspost",c.values.isCrosspost));c.values.scheduledLiveCrosspostPayload&&(a=a.set("scheduledLiveCrosspostPayload",c.values.scheduledLiveCrosspostPayload));break;default:break}return a};a.prototype.saveProps=function(a,b){return a.set("failureRetries",0).set("vp8",b.vp8).set("formData",b.formData)};a.prototype.$LiveVideoBroadcastBroadcastStore11=function(){b("LiveVideoBroadcastDispatcher").waitFor([b("LiveVideoBroadcastAPIBroadcastStore").getDispatchToken()]);var a=this.get("actorID"),c=this.get("targetID");a&&c&&this.$LiveVideoBroadcastBroadcastStore13(a,c)};a.prototype.$LiveVideoBroadcastBroadcastStore13=function(a,c){__p&&__p();this.$LiveVideoBroadcastBroadcastStore2&&this.$LiveVideoBroadcastBroadcastStore2.abandon();var d=b("LiveVideoBroadcastAPIBroadcastStore").getState().toObject(),e=d.is360Audio,f=d.is360Video,g=d.isContentProtectionEnabled,h=d.isSingleFisheye,i=d.singleFisheyeFOV;d=d.sphericalConfigSelectorValue;var j=b("VideoProjection").EQUIRECTANGULAR,k=b("VideoStereoFormat").MONO;d&&(j=d.getAuxiliaryData().projection,k=d.getAuxiliaryData().stereoMode);d=b("XLiveVideoCreateBroadcastController").getURIBuilder().setInt("app_id",n).setFBID("target_id",String(c)).setBool("enable_content_protection",g).setBool("is_360_broadcast",f);f&&(d=d.setBool("is_360_audio_broadcast",e).setBool("is_single_fisheye_broadcast",h).setInt("single_fisheye_fov",i).setEnum("projection",j).setEnum("stereoscopic_mode",k));d=d.getURI();d=b("ActorURI").create(d,a);this.$LiveVideoBroadcastBroadcastStore2=new(b("AsyncRequest"))(d).setData({video_broadcast_infra_type:"RTMP"}).setHandler(function(d){this.$LiveVideoBroadcastBroadcastStore2=null,b("LiveVideoBroadcastActions").apiBroadcastCreated(a||"",d.payload.id,d.payload.stream_url,d.payload.secure_stream_url,d.payload.video_id,c||"",d.payload.embed_html,"",d.payload.backup_stream_url,d.payload.backup_secure_stream_url)}.bind(this)).setMethod("POST");this.$LiveVideoBroadcastBroadcastStore2.send()};a.prototype.$LiveVideoBroadcastBroadcastStore12=function(a,c){__p&&__p();c=b("LiveVideoBroadcastAfterBootloadUtils").getIDsFromTarget(c,a.get("accountID"));var d=c.actorID,e=c.targetID;a=a.set("actorID",d);a=a.set("targetID",e);c=3e4;this.$LiveVideoBroadcastBroadcastStore1&&this.$LiveVideoBroadcastBroadcastStore1.abandon();var f=b("XLiveVideoCreateBroadcastController").getURIBuilder().setFBID("target_id",e).getURI();f=b("ActorURI").create(f,d);this.$LiveVideoBroadcastBroadcastStore1=new(b("AsyncRequest"))(f).setHandler(function(a){this.$LiveVideoBroadcastBroadcastStore1=null;var c=b("LiveVideoBroadcastUIStore").get("composerConfig");if(!c){b("LiveVideoBroadcastUtils").handleCreateBroadcastError({error:"No broadcast config"});return}var f=b("LiveVideoBroadcastUtils").getComposerFormData(c.contextConfig.composerID,e,c.config.contextInfo);b("LiveVideoBroadcastUtils").fetchUIConfig(d,e,a.payload.id,c.contextConfig.composerType,f)}.bind(this)).setErrorHandler(b("LiveVideoBroadcastUtils").handleCreateBroadcastError).setMethod("POST").setTimeoutHandler(c,b("LiveVideoBroadcastUtils").handleCreateBroadcastError);this.$LiveVideoBroadcastBroadcastStore1.send();this.$LiveVideoBroadcastBroadcastStore13(d,e);return a};a.prototype.$LiveVideoBroadcastBroadcastStore14=function(a){__p&&__p();var c=a.getAudioTracks();if(c.length===0){b("RTCUtils").stopMediaStream(a);b("LiveVideoBroadcastActions").updateCameraState(l.MICROPHONE_NOT_FOUND);return!1}c=a.getVideoTracks();if(c.length===0){b("RTCUtils").stopMediaStream(a);b("LiveVideoBroadcastActions").updateCameraState(l.CAMERA_NOT_FOUND);return!1}c[0].readyState==="ended"&&b("LiveVideoBroadcastActions").readyStateEnded();return!0};a.prototype.$LiveVideoBroadcastBroadcastStore7=function(a){__p&&__p();var c=function(a){__p&&__p();if(!this.$LiveVideoBroadcastBroadcastStore14(a))return;b("RTCCallActions").removeAllLocalStreams(!0);b("RTCCallActions").removeAllLocalScreenStreams(!0);b("RTCCallActions").addLocalScreenStream(a);b("LiveVideoBroadcastActions").getScreenStreamUrlSuccess({mediaStream:a});b("LiveVideoBroadcastActions").updateCameraState(l.BROADCAST);a=a.getVideoTracks();a[0].addEventListener("ended",function(){var a=b("LiveVideoBroadcastUIStore").getState().toObject();a=a.broadcastState;a===j.LIVE?this.finishBroadcast():b("LiveVideoBroadcastActions").getWebcamStreamUrlRequest()}.bind(this));this.$LiveVideoBroadcastBroadcastStore3=a[0].getSettings().height}.bind(this);a=this.$LiveVideoBroadcastBroadcastStore15(a);var d={audio:a,video:!1},e=b("RTCCallStore").getState().localUser.getScreenStream();return e?b("RTCUtils").getUserMedia(d).then(function(a){__p&&__p();for(var b=e.getAudioTracks(),c=Array.isArray(b),d=0,b=c?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(c){if(d>=b.length)break;f=b[d++]}else{d=b.next();if(d.done)break;f=d.value}f=f;e.removeTrack(f)}e.addTrack(a.getAudioTracks()[0]);return e})["catch"](function(a){b("LiveVideoBroadcastActions").errorMediaValidation(a,!0)}):b("RTCUtils").getUserScreenMedia({audio:!1,video:{frameRate:{ideal:5,max:15},height:{exact:1080},mediaSource:"screen",width:{max:1920}}},b("MediaRequestSourceApp").LIVE_BROADCAST).then(function(a){return b("RTCUtils").getUserMedia(d).then(function(b){a.addTrack(b.getAudioTracks()[0]);return a})}).then(c)["catch"](function(a){b("LiveVideoBroadcastActions").errorMediaValidation(a,!0)})};a.prototype.createWebcamStreamUrl=function(a,c){__p&&__p();this.$LiveVideoBroadcastBroadcastStore4=!0;var d={width:{min:640,ideal:1280,max:1920},height:{min:480,ideal:720,max:1080},aspectRatio:{ideal:k.SIXTEEN_NINE},frameRate:{ideal:30,max:30}};a=this.$LiveVideoBroadcastBroadcastStore15(a);var e=this.get("streamSettings");e&&e.simpleConstaints?d={height:{ideal:368},aspectRatio:{ideal:k.SIXTEEN_NINE}}:e&&e.firefoxSimpleConstraints&&(d={height:720,aspectRatio:k.SIXTEEN_NINE});c&&(d=babelHelpers["extends"]({},d,{deviceId:c}));e={audio:a,video:d};c=function(a){__p&&__p();this.$LiveVideoBroadcastBroadcastStore4=!1;var c=b("LiveVideoBroadcastUIStore").get("shouldBeClosed");if(c){b("RTCUtils").stopMediaStream(a);return}if(!this.$LiveVideoBroadcastBroadcastStore14(a))return;b("RTCCallActions").removeAllLocalStreams(!0);b("RTCCallActions").removeAllLocalScreenStreams(!0);b("RTCCallActions").addLocalStream(a);b("LiveVideoBroadcastActions").getWebcamStreamUrlSuccess({mediaStream:a});b("LiveVideoBroadcastActions").updateCameraState(l.BROADCAST);c=a.getVideoTracks();c[0].addEventListener("ended",function(){var a=b("LiveVideoBroadcastUIStore").getState().toObject();a=a.broadcastState;a===j.LIVE&&b("LiveVideoBroadcastActions").errorTrackEnded()});this.$LiveVideoBroadcastBroadcastStore3=c[0].getSettings().height}.bind(this);return this.$LiveVideoBroadcastBroadcastStore16(e).then(c)["catch"](function(a){this.$LiveVideoBroadcastBroadcastStore4=!1;b("LiveVideoBroadcastActions").errorMediaValidation(a,!0);var c=a.name==="NotAllowedError"||a.name==="PermissionDismissedError";c=c?l.CAMERA_NOT_ALLOWED:l.CAMERA_NOT_FOUND;b("LiveVideoBroadcastActions").updateCameraState(c,a)}.bind(this))};a.prototype.$LiveVideoBroadcastBroadcastStore15=function(a){var b={echoCancellation:!1,channelCount:2,deviceId:a},c=this.get("streamSettings");c&&c.simpleConstaints&&(b={deviceId:a});return b};a.prototype.$LiveVideoBroadcastBroadcastStore16=function(a){return b("RTCUtils").getUserMedia(a)};a.prototype.$LiveVideoBroadcastBroadcastStore17=function(event){var a=this.get("recordedChunks");a&&event&&event.data.size>0&&a.push(event.data)};a.prototype.$LiveVideoBroadcastBroadcastStore8=function(){var a=this.get("mediaStream");a&&b("RTCUtils").stopMediaStream(a)};a.prototype.$LiveVideoBroadcastBroadcastStore9=function(){var a=this.get("videoId");if(!a)return;b("UFILiveStreamingComments").stop(a)};a.prototype.startBroadcast=function(a){__p&&__p();var c=this.get("broadcastId")||"",d=this.get("streamSettings"),e=this.get("vp8")?{video:"VP8/90000"}:{video:"H264/90000"};b("RTCCallActions").addListener("onIceConnectionStateChange",function(a){a==="disconnected"?b("LiveVideoBroadcastActions").errorConnectionBroken():a==="connected"?b("LiveVideoBroadcastActions").webRTCConnectionEstablished():b("LiveVideoBroadcastActions").iceConnectionStateChanged(a),a==="failed"&&b("LiveVideoBroadcastActions").attemptReconnection()});var f={};d&&(f={"H264/90000":{"x-google-start-bitrate":d.initialBitrate},"opus/48000/2":{minaveragebitrate:d.minAudioBitrate,maxaveragebitrate:d.maxAudioBitrate},"VP8/90000":d.maxVideoBitrate?{"x-google-max-bitrate":d.maxVideoBitrate}:{}});var g=b("RTCCallStore").getState();g=g.localUser;g=[].concat(g.streams.toArray(),g.screenStreams.toArray());var h=undefined;d&&d.firefoxSimpleConstraints&&(h=function(a){var b=this.$LiveVideoBroadcastBroadcastStore3?this.$LiveVideoBroadcastBroadcastStore3/360:1;a.setParameters(babelHelpers["extends"]({},a.getParameters(),{encodings:[{maxBitrate:1e6,scaleResolutionDownBy:b}]}))}.bind(this));d=new(b("RTCMWProtocolHandler"))();d.startCall([],g,"LIVE:"+c,{addStreamCallback:h,callTrigger:"live_video",formatParameters:f,preferredCodecs:e});d=b("XLiveVideoPublishBroadcastController").getURIBuilder().setFBID("broadcast_id",c);g=b("ActorURI").create(d.getURI(),this.get("actorID"));h=this.get("formData");f=b("LiveVideoBroadcastUIStore").getState().toObject();e=f.composerConfig;if(e){d=b("LiveVideoBroadcastUtils").getComposerFormData(e.contextConfig.composerID,e.contextConfig.targetID,e.config.contextInfo);for(var i in h)d[i]!==null&&(h[i]=d[i])}new(b("AsyncRequest"))().setURI(g).setData(h).setHandler(function(){return b("LiveVideoBroadcastActions").startLiveBroadcastSuccess()}).setErrorHandler(function(a){return b("LiveVideoBroadcastActions").errorBroadcastCouldNotStart()}).send();b("LiveVideoBroadcastCopyrightUtils").subscribeToCopyrightEvents(c);f=Math.max(b("LiveVideoBroadcastConstants").PUBLISH_FAILURE_TIMEOUT_S-5,0);b("setTimeout")(function(){return this.$LiveVideoBroadcastBroadcastStore18()}.bind(this),f*1e3);e=null;if(a){d=this.get("mediaStream");g={mimeType:"video/webm; codecs=vp9"};e=new(b("MediaRecorder"))(d,g);e.ondataavailable=function(event){return this.$LiveVideoBroadcastBroadcastStore17(event)}.bind(this);e.start()}return e};a.prototype.attemptReconnection=function(a,c){__p&&__p();var d=b("LiveVideoBroadcastUIStore").getState().toObject(),e=d.connectionBroken;d=d.broadcastState;if(a<c&&d===j.LIVE&&e){a=new(b("RTCMWProtocolHandler"))();a.iceRestart("LIVE:"+(this.get("broadcastId")||""),b("RTCCallStore").getState().callInfo.serverInfoData);b("setTimeout")(function(){return b("LiveVideoBroadcastActions").attemptReconnection()},(this.get("retryTimeoutSeconds")||b("LiveVideoBroadcastConstants").DEFAULT_RETRY_TIMEOUT_SECONDS)*1e3)}else e&&b("setTimeout")(function(){return b("LiveVideoBroadcastActions").errorConnectionFailed()},1)};a.prototype.$LiveVideoBroadcastBroadcastStore18=function(a){__p&&__p();var c=this.get("broadcastId")||"";a=a?b("LiveVideoBroadcastConstants").PUBLISH_FAILURE_TIMEOUT_S*1.5:b("LiveVideoBroadcastConstants").PUBLISH_FAILURE_TIMEOUT_S;var d=this.getCurrentBroadcastTime()>a;a=b("XLiveVideoCheckIsPublishedController").getURIBuilder().setFBID("broadcast_id",c).setBool("end_if_unpublished",d).getURI();var e=function(a,c){var e=b("LiveVideoBroadcastUIStore").getState().toObject();e=e.broadcastState;if(e===j.FINISHED)return;e=a.payload;e.is_published||(d?b("LiveVideoBroadcastActions").errorTimeOutWaitingForPublish("CLIENT"):b("setTimeout")(function(){this.$LiveVideoBroadcastBroadcastStore18(c)}.bind(this),o))}.bind(this);new(b("AsyncRequest"))().setURI(a).setHandler(function(a){return e(a,!1)}).setErrorHandler(function(a){return e(a,!0)}).send()};a.prototype.$LiveVideoBroadcastBroadcastStore5=function(){__p&&__p();var a=b("LiveVideoBroadcastIDStore").get("broadcastID"),c=this.get("targetID");if(!a||!c){b("setTimeout")(function(){return b("LiveVideoBroadcastActions").requestUFI()},o);return}a=b("XLiveVideoInitCommentsController").getURIBuilder().setFBID("broadcast_id",a).setFBID("target_id",c);c=b("ActorURI").create(a.getURI(),this.get("actorID"));a=function(a){a=a.payload;if(!a.success){b("setTimeout")(function(){return b("LiveVideoBroadcastActions").requestUFI()},o);return}b("LiveVideoBroadcastActions").updateBroadcastUIConfig({feedbackID:a.feedbackID})};new(b("AsyncRequest"))().setURI(c).setHandler(a).setErrorHandler(a).send()};a.prototype.$LiveVideoBroadcastBroadcastStore6=function(){var a=b("LiveVideoBroadcastUIStore").getState().toObject();a=a.inputSource;a!==m.CAMERA&&this.$LiveVideoBroadcastBroadcastStore8()};a.prototype.finishBroadcast=function(){__p&&__p();var a=b("LiveVideoBroadcastUIStore").getState().toObject();a=a.inputSource;if(a!==m.CAMERA)return;var c=this.get("broadcastId")||"",d=this.get("videoId")||"";b("setTimeout")(function(){return b("RTCCallActions").removeAllLocalStreams(!0)},0);a=b("XLiveVideoFinishBroadcastController").getURIBuilder().setFBID("broadcast_id",c);b("ActorURI").create(a.getURI(),this.get("actorID"));b("setTimeout")(function(){b("RTCMWProtocolHandler").endCall("LIVE:"+c,b("RTCCallStore").getState().callInfo.serverInfoData,b("FBRTCHangupReason").HANGUP_CALL,"User ending live stream"),b("Bootloader").loadModules(["ModernLiveVideoEndMutation","RelayFBEnvironment"],function(a,c){a.commit(c,{videoID:d},{onCompleted:function(){b("LiveVideoBroadcastActions").finishBroadcastSuccess()},onError:function(a){b("LiveVideoBroadcastActions").errorEndBroadcastMutationFail(a),b("ErrorDialog").show(g._("End broadcast error"),g._("Error ending broadcast, please try again"))}})},"LiveVideoBroadcastBroadcastStore")},1e3*3);a=this.get("recorder");var e=this.get("recordedChunks");if(a&&e){a.stop();a=new Blob(e,{type:"video/webm"});e=URL.createObjectURL(a);a=document.createElement("a");document.body&&(document.body.appendChild(a),a.style.cssText="display: none",a.href=e,a.download="test.webm",a.click(),window.URL.revokeObjectURL(e))}};a.prototype.$LiveVideoBroadcastBroadcastStore10=function(){var a=this.get("videoId");a&&this.deleteVideo(a)};a.prototype.deleteVideo=function(a){new(b("AsyncRequest"))().setURI("/ajax/video/actions/delete/").setData({fbid:a,redirect:!1}).setHandler(function(a){}).send()};a.prototype.prepareThumbnailUri=function(){var a=this.get("videoId")||"";a=b("XLiveVideoBroadcastReplayController").getURIBuilder().setFBID("video_id",a).getURI();new(b("AsyncRequest"))().setURI(a).setMethod("POST").setHandler(function(a){return b("LiveVideoBroadcastActions").setThumbnailUri(a.getPayload())}).send()};a.prototype.getCurrentBroadcastTime=function(){var a=this.get("broadcastStartTime");return typeof a==="number"?Math.floor((Date.now()-a)/1e3):0};a.__moduleID=e.id;e.exports=new a(b("LiveVideoBroadcastDispatcher"))}),null);
__d("LiveVideoBroadcastIDStore",["FluxDerivedStore","LiveVideoBroadcastAPIBroadcastStore","LiveVideoBroadcastBroadcastStore","LiveVideoBroadcastDispatcher","LiveVideoBroadcastUIStore"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;g=babelHelpers.inherits(a,b("FluxDerivedStore"));g&&g.prototype;a.prototype.__getStores=function(){return[b("LiveVideoBroadcastAPIBroadcastStore"),b("LiveVideoBroadcastBroadcastStore"),b("LiveVideoBroadcastUIStore")]};a.prototype.__getData=function(a){a=b("LiveVideoBroadcastUIStore").get("inputSource");var c=b("LiveVideoBroadcastAPIBroadcastStore").getState().toObject(),d=c.apiBroadcastID;c=c.apiVideoID;var e=b("LiveVideoBroadcastBroadcastStore").getState().toObject();return{inputSource:a,apiBroadcastID:d,apiVideoID:c,cameraBroadcastID:e.broadcastId,cameraVideoID:e.videoId}};a.prototype.__computeResult=function(a,b){if(b.inputSource==="CAMERA"||b.inputSource==="EDIT")switch(a){case"broadcastID":return b.cameraBroadcastID;case"videoID":return b.cameraVideoID}if(b.inputSource==="API"||b.inputSource==="VIDEO_GAME"||b.inputSource==="EDIT_SCHEDULE")switch(a){case"broadcastID":return b.apiBroadcastID;case"videoID":return b.apiVideoID}return null};function a(){g.apply(this,arguments)}a.__moduleID=e.id;e.exports=new a(b("LiveVideoBroadcastDispatcher"))}),null);
__d("XLiveVideoBroadcastMaybeLaunchEndScreenSurveyController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/ajax/live/broadcast/end_screen_survey/",{broadcast_id:{type:"FBID",required:!0}})}),null);
__d("LiveVideoBroadcastUIStore",["fbt","AsyncRequest","ComposerEntryPointRef","ComposerVideoShowsActions","ComposerVideoShowsDispatcher","ComposerVideoShowsStore","ErrorDialog","FluxMapStore","LiveVideoBroadcastAfterBootloadUtils","LiveVideoBroadcastBroadcastStore","LiveVideoBroadcastConstants","LiveVideoBroadcastDispatcher","ReactComposerActions","ReactComposerAttachmentActions","ReactComposerAttachmentType","ReactComposerFundraiserAttachmentActions","ReactComposerLoggingName","ReactComposerTaggerActions","ReactComposerTaggerType","ReactDOM","XLiveVideoBroadcastMaybeLaunchEndScreenSurveyController","ge","immutable"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i=b("LiveVideoBroadcastConstants").ACTIONS,j=b("LiveVideoBroadcastConstants").BROADCAST_STATE,k=b("LiveVideoBroadcastConstants").CAMERA_STATE,l=b("LiveVideoBroadcastConstants").INPUT_SOURCE,m=b("LiveVideoBroadcastConstants").ENCODER_TYPE,n=b("LiveVideoBroadcastConstants").RHC_TAB_TYPE;h=babelHelpers.inherits(a,b("FluxMapStore"));h&&h.prototype;a.prototype.getInitialState=function(){return b("immutable").Map({broadcastCouldNotStart:!1,broadcastCouldNotPublish:!1,broadcastState:j.PREVIEW,cameraState:k.CHECK_CAMERA_ACCESS,canSeeCopyrightOption:!1,canSeeDisturbingOptions:!1,countdownTime:null,connectionBroken:!1,connectionFailed:!1,dialog:null,dialogContainerID:null,composerConfig:null,isOnline:!0,isUpdateRequestPending:!1,showNUX:!1,showReplay:!1,startTime:0,wasEverOffline:!1,ufiConfig:{},ufiMarkup:null,isDescriptionExpanded:!1,warnOnExit:!0,tagList:null,peopleTaggerSource:null,inputSource:l.CAMERA,isScheduledLiveRequestPending:!1,showSaveChangesDialog:!1,sponsorEnabled:!1,sponsorConfig:null,isDialogLoading:!1,hideInputToggle:!1,shouldBeClosed:!0,canEndLiveVideo:!1,canEnableLiveCoverVideo:!1,isLiveCoverVideoEnabled:!1,selectedEncoderName:null,selectedEncoderType:m.STREAM_KEY,selectedRHCTab:n.POST,isRewindEnabled:!1,canEnableRewind:!1,commentModes:[]})};a.prototype.reduce=function(a,c){__p&&__p();switch(c.type){case i.SHOW_REPLAY:a=a.set("showReplay",!0);break;case i.SET_UPDATE_REQUEST_PENDING:a=a.set("isUpdateRequestPending",c.value);break;case i.UPDATE_CAMERA_STATE:a=a.set("cameraState",c.value);break;case i.UPDATE_COUNTDOWN:a=a.set("countdownTime",c.value);break;case i.FINISH_COUNT_DOWN:a=a.set("startTime",Date.now());a=a.set("broadcastState",j.READY_TO_LIVE);a=a.set("countdownTime",null);break;case i.API_GO_LIVE_CLICKED:a=a.set("startTime",Date.now());break;case i.START_BROADCAST_SUCCESS:a=a.set("broadcastState",j.LIVE);a=a.set("countdownTime",null);break;case i.START_LIVE_COUNTDOWN:a=a.set("countdownTime",b("LiveVideoBroadcastConstants").COUNTDOWN_START_TIME);break;case i.CANCEL_LIVE_COUNTDOWN:a=a.set("countdownTime",null);break;case i.FINISH_BROADCAST_REQUEST:a=a.set("broadcastState",j.FINISHING);break;case i.FINISH_BROADCAST_SUCCESS:a=a.set("broadcastState",j.FINISHED);a=a.set("showReplay",!0);var d=b("LiveVideoBroadcastBroadcastStore").get("broadcastId");d=b("XLiveVideoBroadcastMaybeLaunchEndScreenSurveyController").getURIBuilder().setFBID("broadcast_id",d).getURI();new(b("AsyncRequest"))().setURI(d).setMethod("GET").setReadOnly(!0).send();break;case i.API_BROADCAST_STOPPED:a=a.set("broadcastState",j.FINISHED);a=a.set("showReplay",!0);break;case i.ERROR_CONNECTION_BROKEN:a=a.set("connectionBroken",!0);break;case i.ERROR_CONNECTION_FAILED:a=a.set("connectionFailed",!0);break;case i.WEBRTC_CONNECTION_ESTABLISHED:a=a.set("connectionBroken",!1);break;case i.ERROR_BROADCAST_COULD_NOT_START:a=a.set("broadcastCouldNotStart",!0);break;case i.ERROR_BROADCAST_PUBLISH_FAIL:case i.ERROR_TIME_OUT_WAITING_FOR_PUBLISH:case i.ERROR_MWS_BAD_AUDIO_OR_VIDEO_DATA:case i.ERROR_RTC_CLIENT_ERROR:case i.ERROR_TRACK_ENDED:a=a.set("broadcastCouldNotPublish",!0);a=a.set("broadcastState",j.FINISHED);break;case i.ACCEPT_ERROR_BROADCAST_COULD_NOT_START:a=a.set("broadcastCouldNotStart",!1);break;case i.ERROR_STARTING_API_BROADCAST:b("LiveVideoBroadcastAfterBootloadUtils").showErrorDialog();break;case i.NETWORK_OFFLINE:a=a.set("isOnline",!1);a=a.set("wasEverOffline",!0);break;case i.NETWORK_ONLINE:a=a.set("isOnline",!0);break;case i.SET_SHOW_NUX:a=a.set("showNUX",c.value);break;case i.SETUP_UFI:a.get("broadcastState")===j.LIVE&&(a=a.set("ufiConfig",c.ufiConfig),a=a.set("ufiMarkup",c.ufiMarkup));break;case i.SET_DIALOG:a=a.set("dialog",c.value);break;case i.SET_DIALOG_CONTAINER_ID:a=a.set("dialogContainerID",c.value);break;case i.SET_COMPOSER_CONFIG:a=a.set("composerConfig",c.value);break;case i.SET_DESCRIPTION_EXPANDED:a=a.set("isDescriptionExpanded",c.value);break;case i.INITIALIZE:a=a.set("shouldBeClosed",!1);c.value&&c.value.inputSource!=null&&(a=a.set("inputSource",c.value.inputSource));break;case i.CLEANUP:a=this.getInitialState();a=a.set("warnOnExit",!1);this.$LiveVideoBroadcastUIStore1();break;case i.SCHEDULED_LIVE_SUCCESS:c.shouldCloseDialog?(a=this.getInitialState(),a=a.set("warnOnExit",!1),this.$LiveVideoBroadcastUIStore1(!0)):a=a.set("isScheduledLiveRequestPending",!1);break;case i.PREPARE_BROADCAST_FOR_SCHEDULED_LIVE:case i.SCHEDULED_LIVE_REQUEST:a=a.set("isScheduledLiveRequestPending",!0);break;case i.SCHEDULED_LIVE_FAIL:a=a.set("isScheduledLiveRequestPending",!1);this.$LiveVideoBroadcastUIStore2();break;case i.SET_DESCRIPTION:a=a.set("description",c.value.description);a=a.set("shortDescription",c.value.shortDescription);break;case i.SET_TAG_LIST:a=a.set("tagList",c.value);break;case i.SET_PRIVACY_SELECTOR:a=a.set("privacySelector",c.value);break;case i.SET_PEOPLE_TAGGER_SOURCE:a=a.set("peopleTaggerSource",c.value);break;case i.SET_TARGET:case i.CLEAR_BROADCAST_ID:a=a.set("composerPrivacySelector",null);a=a.set("profilePicUri",null);a=a.set("sponsorEnabled",!1);a=a.set("targetingEnabled",!1);a=a.set("canEnableRewind",!1);a=a.set("isRewindEnabled",!1);a=a.set("selectedEncoderName",null);a=this.$LiveVideoBroadcastUIStore3(a,!1);break;case i.UPDATE_UI_CONFIG:c.values.encoders&&(a=a.set("encoders",c.values.encoders));c.values.composerPrivacySelector&&(a=a.set("composerPrivacySelector",c.values.composerPrivacySelector));c.values.shareMode&&(a=a.set("shareMode",c.values.shareMode));c.values.description&&(a=a.set("description",c.values.description));c.values.shortDescription&&(a=a.set("shortDescription",c.values.shortDescription));c.values.showNUX&&(a=a.set("showNUX",c.values.showNUX));c.values.tagList&&(a=a.set("tagList",c.values.tagList));c.values.privacySelector&&(a=a.set("privacySelector",c.values.privacySelector));c.values.profileLink&&(a=a.set("profileLink",c.values.profileLink));c.values.broadcasterName&&(a=a.set("broadcasterName",c.values.broadcasterName));if(c.values.gks){d=!!c.values.gks.live_rewind_option_in_composer;a=a.set("gks",c.values.gks);a=a.set("canEnableRewind",d);d&&c.values.isRewindEnabled!=undefined&&(a=a.set("isRewindEnabled",c.values.isRewindEnabled))}c.values.commentModes&&(a=a.set("commentModes",c.values.commentModes));c.values.targetSelectorProps&&(a=a.set("targetSelectorProps",c.values.targetSelectorProps));c.values.profilePicUri&&(a=a.set("profilePicUri",c.values.profilePicUri));c.values.accessToken&&(a=a.set("accessToken",c.values.accessToken));c.values.timezoneString&&(a=a.set("timezoneString",c.values.timezoneString));c.values.cameraEmbedHTML!==undefined&&(a=a.set("cameraEmbedHTML",c.values.cameraEmbedHTML));c.values.targetingEnabled!==undefined&&(a=a.set("targetingEnabled",c.values.targetingEnabled));c.values.fundraiserEnabled!==undefined&&(a=this.$LiveVideoBroadcastUIStore3(a,Boolean(c.values.fundraiserEnabled)));c.values.canSeeDisturbingOptions!==undefined&&(a=a.set("canSeeDisturbingOptions",c.values.canSeeDisturbingOptions));c.values.sponsorEnabled!==undefined&&(a=a.set("sponsorEnabled",c.values.sponsorEnabled));c.values.sponsorConfig&&(a=a.set("sponsorConfig",c.values.sponsorConfig));c.values.canSeeCopyrightOption!==undefined&&(a=a.set("canSeeCopyrightOption",c.values.canSeeCopyrightOption));if(c.values.targetID&&c.values.targetID!==b("LiveVideoBroadcastBroadcastStore").get("targetID")){if(c.values.isShowPage){b("ComposerVideoShowsDispatcher").explicitlyRegisterStore(b("ComposerVideoShowsStore"));d=this.get("composerConfig");var e=d&&d.composerID;e&&setTimeout(function(){return b("ComposerVideoShowsActions").initialize(e,b("ComposerEntryPointRef").LIVE_BROADCAST,!1)},0)}a=a.set("episodeData",null)}if(c.values.episodeData!=undefined){var f=c.values.episodeData;a=a.set("episodeData",f);b("ComposerVideoShowsDispatcher").explicitlyRegisterStore(b("ComposerVideoShowsStore"));d=this.get("composerConfig");var g=d&&d.composerID;g&&setTimeout(function(){b("ComposerVideoShowsActions").initialize(g,b("ComposerEntryPointRef").LIVE_BROADCAST,!0),b("ComposerVideoShowsActions").loadEpisodeData(g,f)},0)}c.values.isShowPage!==undefined&&(a=a.set("isShowPage",c.values.isShowPage));c.values.canEndLiveVideo!=undefined&&(a=a.set("canEndLiveVideo",c.values.canEndLiveVideo));d=c.values.pageLiveCoverVideoData;d&&(a=a.set("isLiveCoverVideoEnabled",d.isLiveCoverVideoEnabled),a=a.set("canEnableLiveCoverVideo",d.canEnableLiveCoverVideo));c.values.hasGamingContext&&(a=a.set("hasGamingContext",c.values.hasGamingContext),a.get("inputSource")===l.API&&(a=a.set("inputSource",l.VIDEO_GAME)));break;case i.SET_INPUT_SOURCE:a=a.set("inputSource",c.source);break;case i.SET_DIALOG_LOADING:a=a.set("isDialogLoading",c.value);break;case i.SET_EPISODE_DATA:a=a.set("episodeData",c.episodeData);break;case i.SET_HIDE_INPUT_TOGGLE:a=a.set("hideInputToggle",c.hideInputToggle);break;case i.SET_BROADCAST_STATE:a=a.set("broadcastState",c.broadcastState);break;case i.SET_START_TIME:a=a.set("startTime",c.startTime);break;case i.SET_LIVE_COVER_VIDEO_ENABLED:a=a.set("isLiveCoverVideoEnabled",c.value);break;case i.SET_SELECTED_ENCODER_NAME:a=a.set("selectedEncoderName",c.encoderName);break;case i.SET_SELECTED_ENCODER_TYPE:a=a.set("selectedEncoderType",c.encoderType);c.encoderType===m.PAIRED_ENCODER&&(a=a.set("selectedRHCTab",n.SETTINGS));break;case i.SET_SELECTED_RHC_TAB:a=a.set("selectedRHCTab",c.selectedTab);break;case i.SET_REWIND_ENABLED:a=a.set("isRewindEnabled",c.enabled);break;case i.SET_SHOW_SAVE_CHANGES_DIALOG:a=a.set("showSaveChangesDialog",c.value);break;case i.SET_COMMENT_MODES:a=a.set("commentModes",c.value);break;default:break}return a};a.prototype.$LiveVideoBroadcastUIStore2=function(){b("ErrorDialog").show(g._("Broadcast error"),g._("Error scheduling broadcast, please try again"))};a.prototype.$LiveVideoBroadcastUIStore4=function(){var a=this.get("composerConfig");a=a&&a.composerID;a&&(b("ReactComposerTaggerActions").setTaggerData(a,b("ReactComposerLoggingName").FUNDRAISER_SPROUT,b("ReactComposerTaggerType").FUNDRAISER,{}),b("ReactComposerFundraiserAttachmentActions").setMarkup(a,null))};a.prototype.$LiveVideoBroadcastUIStore3=function(a,b){a=a.set("fundraiserEnabled",b);b||this.$LiveVideoBroadcastUIStore4();return a};a.prototype.$LiveVideoBroadcastUIStore1=function(a){__p&&__p();var c=this.get("dialog");if(c){var d=b("ge")(this.get("dialogContainerID"));d&&b("ReactDOM").unmountComponentAtNode(d);c.destroy()}else window.close();d=this.get("composerConfig");c=this.get("broadcastState");d=d&&d.composerID;d&&(a||c!==j.PREVIEW&&c!==j.READY_TO_LIVE?b("ReactComposerActions").reset(d):b("ReactComposerAttachmentActions").selectAttachment(d,b("ReactComposerAttachmentType").STATUS))};function a(){h.apply(this,arguments)}a.__moduleID=e.id;e.exports=new a(b("LiveVideoBroadcastDispatcher"))}),null);
__d("LiveControlPanelUnifiedCreateButtonContainer.react",["FluxContainer","LiveControlPanelUnifiedCreateButton.react","LiveVideoBroadcastDispatcher","LiveVideoBroadcastUIStore","React"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c=babelHelpers.inherits(a,b("React").Component);g=c&&c.prototype;function a(a){g.constructor.call(this,a),b("LiveVideoBroadcastDispatcher").explicitlyRegisterStores([b("LiveVideoBroadcastUIStore")])}a.getStores=function(){return[b("LiveVideoBroadcastUIStore")]};a.calculateState=function(){var a=b("LiveVideoBroadcastUIStore").getState().toObject();a=a.isDialogLoading;return{isDialogLoading:a}};a.prototype.render=function(){return b("React").createElement(b("LiveControlPanelUnifiedCreateButton.react"),{isDialogLoading:this.state.isDialogLoading})};e.exports=b("FluxContainer").create(a)}),null);
__d("LiveControlPanelUnifiedCreateButtonServerCallable.react",["LiveControlPanelUnifiedCreateButtonContainer.react","React"],(function(a,b,c,d,e,f){"use strict";var g;g=babelHelpers.inherits(a,b("React").Component);g&&g.prototype;a.prototype.render=function(){return b("React").createElement(b("LiveControlPanelUnifiedCreateButtonContainer.react"),null)};function a(){g.apply(this,arguments)}e.exports=a}),null);