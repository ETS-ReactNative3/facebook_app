if (self.CavalryLogger) { CavalryLogger.start_js(["cGyNu"]); }

__d("LiveVideoBroadcastLoggingStore",["CurrentUser","FluxMapStore","Live360CameraStateEvents","Live360CameraStateTypedLogger","LiveVideoBroadcastAfterBootloadUtils","LiveVideoBroadcastAPIBroadcastStore","LiveVideoBroadcastBroadcastStore","LiveVideoBroadcastConstants","LiveVideoBroadcastCopyrightEvent","LiveVideoBroadcastCrosspostStore","LiveVideoBroadcastDispatcher","LiveVideoBroadcastFunnelLogger","LiveVideoBroadcastIDStore","LiveVideoBroadcastUIStore","LiveVideoBroadcastUtils","LiveVideoBroadcastWaterfallEvent","LiveVideoBroadcastWaterfallTypedLogger","RTCMediaDevicesStore","RTCUserSettingsStore","Video360LiveCameraNames","VideoBroadcastLoggerEvent","VideoBroadcastTypedLogger","uuid"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=b("LiveVideoBroadcastConstants").ACTIONS,i=b("LiveVideoBroadcastConstants").BROADCAST_STATE,j=b("LiveVideoBroadcastConstants").CAMERA_STATE;g=babelHelpers.inherits(a,b("FluxMapStore"));g&&g.prototype;a.prototype.reduce=function(a,c){__p&&__p();switch(c.type){case h.GET_WEBCAM_STREAM_URL_REQUEST:var d=c.config?c.config.audioInput:null,e=c.config?c.config.videoInput:null,f=b("RTCMediaDevicesStore").getState(),g=f&&d?f.find(function(a){return a.deviceId===d}):null;f=f&&e?f.find(function(a){return a.deviceId===e}):null;g=g?g.label:d;f=f?f.label:e;this.$LiveVideoBroadcastLoggingStore1(b("LiveVideoBroadcastWaterfallEvent").UI_REQUEST_WEBCAM_STREAM,null,{audioDevice:g,videoDevice:f});break;case h.SCHEDULED_LIVE_SUCCESS:this.$LiveVideoBroadcastLoggingStore1(b("LiveVideoBroadcastWaterfallEvent").UI_SCHEDULED_LIVE_SUCCESS);break;case h.INITIALIZE:this.$LiveVideoBroadcastLoggingStore1(b("LiveVideoBroadcastWaterfallEvent").UI_INITIALIZE);break;case h.SCHEDULED_LIVE_FAIL:this.$LiveVideoBroadcastLoggingStore1(b("LiveVideoBroadcastWaterfallEvent").UI_SCHEDULED_LIVE_FAIL,null,{response:c.response});break;case h.SET_TARGET:g=b("LiveVideoBroadcastAfterBootloadUtils").getIDsFromTarget(c.value,b("LiveVideoBroadcastBroadcastStore").get("accountID"));this.$LiveVideoBroadcastLoggingStore1(b("LiveVideoBroadcastWaterfallEvent").UI_SET_TARGET,null,g);break;case h.SET_COMPOSER_CONFIG:a=a.set("sessionID",b("uuid")());break;case h.START_BROADCAST_REQUEST:this.$LiveVideoBroadcastLoggingStore1(b("LiveVideoBroadcastWaterfallEvent").UI_REQUEST_BROADCAST_START,null,{videoInputSource:b("LiveVideoBroadcastBroadcastStore").get("selectedVideoInputSource")});this.$LiveVideoBroadcastLoggingStore2(b("Live360CameraStateEvents").GOLIVE);break;case h.START_LIVE_COUNTDOWN:this.$LiveVideoBroadcastLoggingStore3();break;case h.CANCEL_LIVE_COUNTDOWN:this.$LiveVideoBroadcastLoggingStore1(b("LiveVideoBroadcastWaterfallEvent").UI_CANCEL_COUNTDOWN);b("LiveVideoBroadcastFunnelLogger").goLiveCancelled();break;case h.FINISH_BROADCAST_REQUEST:this.$LiveVideoBroadcastLoggingStore1(b("LiveVideoBroadcastWaterfallEvent").UI_FINISH_LIVE_START);b("LiveVideoBroadcastFunnelLogger").finishClicked();break;case h.DELETE_REPLAY_VIDEO:case h.DELETE_API_REPLAY_VIDEO:this.$LiveVideoBroadcastLoggingStore1(b("LiveVideoBroadcastWaterfallEvent").UI_DELETED_VIDEO);break;case h.FINISH_BROADCAST_SUCCESS:this.$LiveVideoBroadcastLoggingStore1(b("LiveVideoBroadcastWaterfallEvent").UI_ENTERED_FINISHED_STATE);b("LiveVideoBroadcastFunnelLogger").endFinishedFromUser();break;case h.ERROR_BROADCAST_PUBLISH_FAIL:this.$LiveVideoBroadcastLoggingStore1(b("LiveVideoBroadcastWaterfallEvent").PUBLISH_BROADCAST_FAILED);b("LiveVideoBroadcastFunnelLogger").endPublishFailed();break;case h.ERROR_END_BROADCAST_MUTATION_FAIL:this.$LiveVideoBroadcastLoggingStore1(b("LiveVideoBroadcastWaterfallEvent").ERROR_END_BROADCAST_MUTATION_FAIL,i.LIVE,{extraData:c.errorMessage});b("LiveVideoBroadcastFunnelLogger").endMutationFailed();break;case h.UPDATE_CAMERA_STATE:c.value===j.REQUEST_CAMERA_ACCESS?(this.$LiveVideoBroadcastLoggingStore1(b("LiveVideoBroadcastWaterfallEvent").UI_REQUEST_CAMERA_ACCESS),this.$LiveVideoBroadcastLoggingStore2(b("Live360CameraStateEvents").CONNECTED),b("LiveVideoBroadcastFunnelLogger").requestCameraAccess()):c.value===j.CAMERA_NOT_FOUND?b("LiveVideoBroadcastFunnelLogger").endCameraNotFound():c.value===j.MICROPHONE_NOT_FOUND?b("LiveVideoBroadcastFunnelLogger").endMicrophoneNotFound():c.value===j.BROADCAST?b("LiveVideoBroadcastFunnelLogger").foundCamera():c.value===j.CAMERA_NOT_ALLOWED&&b("LiveVideoBroadcastFunnelLogger").cameraPermissionDenied();break;case h.ERROR_MEDIA_VALIDATION:f={mediaValidationError:c.errorMessage,blockedFromGoingLive:c.blockedFromGoingLive};this.$LiveVideoBroadcastLoggingStore1(b("LiveVideoBroadcastWaterfallEvent").CAMERA_NOT_FOUND,null,f,null);break;case h.ERROR_BROADCAST_COULD_NOT_START:this.$LiveVideoBroadcastLoggingStore1(b("LiveVideoBroadcastWaterfallEvent").UI_BROADCAST_COULD_NOT_START);b("LiveVideoBroadcastFunnelLogger").endCouldNotStart();break;case h.ERROR_CONNECTION_BROKEN:this.$LiveVideoBroadcastLoggingStore1(b("LiveVideoBroadcastWaterfallEvent").UI_BROADCAST_DISCONNECTED,i.LIVE,null,"disconnected");a=a.set("iceConnectionState","disconnected");b("LiveVideoBroadcastFunnelLogger").connectionBroken();break;case h.ERROR_CREATING_BROADCAST:this.$LiveVideoBroadcastLoggingStore1(b("LiveVideoBroadcastWaterfallEvent").UI_ERROR_CREATING_BROADCAST,null,c.additionalLoggingData,null);b("LiveVideoBroadcastFunnelLogger").errorCreatingBroadcast();break;case h.ERROR_CONNECTION_FAILED:this.$LiveVideoBroadcastLoggingStore1(b("LiveVideoBroadcastWaterfallEvent").UI_BROADCAST_FAILED,i.LIVE,null,"failed");this.$LiveVideoBroadcastLoggingStore4(b("VideoBroadcastLoggerEvent").FACECASTWITH_RTCCALL_ENDED,i.LIVE,{broadcast_transition_reason:"webrtc_failed"});a=a.set("iceConnectionState","failed");b("LiveVideoBroadcastFunnelLogger").endConnectionFailed();break;case h.WEBRTC_CONNECTION_ESTABLISHED:this.$LiveVideoBroadcastLoggingStore1(b("LiveVideoBroadcastWaterfallEvent").UI_CONNECTION_ESTABLISHED,null,null,"connected");a=a.set("iceConnectionState","connected");b("LiveVideoBroadcastFunnelLogger").uploadStarted();break;case h.ICE_CONNECTION_STATE_CHANGED:this.$LiveVideoBroadcastLoggingStore1(b("LiveVideoBroadcastWaterfallEvent").UI_ICE_CONNECTION_STATE_CHANGED,null,null,c.value);a=a.set("iceConnectionState",c.value);break;case h.SET_COPYRIGHT_TRIGGERED:this.$LiveVideoBroadcastLoggingStore1(b("LiveVideoBroadcastWaterfallEvent").UI_COPYRIGHT_TRIGGERED);break;case h.SET_BROADCAST_ENDED_WITH_COPYRIGHT_VIOLATION:this.$LiveVideoBroadcastLoggingStore1(b("LiveVideoBroadcastWaterfallEvent").UI_COPYRIGHT_END_BROADCAST);b("LiveVideoBroadcastFunnelLogger").endCopyrightViolation();break;case h.HANDLE_COPYRIGHT_EVENT:switch(c.value){case b("LiveVideoBroadcastCopyrightEvent").RESUME_LIVE_VIDEO:this.$LiveVideoBroadcastLoggingStore1(b("LiveVideoBroadcastWaterfallEvent").UI_COPYRIGHT_RESUME_BROADCAST);break;case b("LiveVideoBroadcastCopyrightEvent").AUTO_TAKE_DOWN_LIVE_VIDEO:this.$LiveVideoBroadcastLoggingStore1(b("LiveVideoBroadcastWaterfallEvent").UI_COPYRIGHT_AUTO_TAKEDOWN);break;case b("LiveVideoBroadcastCopyrightEvent").DELETE_LIVE_VIDEO:this.$LiveVideoBroadcastLoggingStore1(b("LiveVideoBroadcastWaterfallEvent").UI_COPYRIGHT_USER_DELETE_BROADCAST);break}break;case h.LOG_WEBRTC_STATS:this.$LiveVideoBroadcastLoggingStore1(b("LiveVideoBroadcastWaterfallEvent").UI_WEBRTC_STATS,null,c.value);break;case h.INVITE_FRIEND:this.$LiveVideoBroadcastLoggingStore1(b("LiveVideoBroadcastWaterfallEvent").UI_INVITED_FRIEND,null,null);break;case h.SET_INVITE_FRIENDS_SHOWN:c.value&&this.$LiveVideoBroadcastLoggingStore1(b("LiveVideoBroadcastWaterfallEvent").UI_INVITE_FRIENDS_OPENED,null,null);break;case h.ERROR_TIME_OUT_WAITING_FOR_PUBLISH:this.$LiveVideoBroadcastLoggingStore1(b("LiveVideoBroadcastWaterfallEvent").UI_TIME_OUT_WAITING_FOR_PUBLISH,null,{errorSource:c.errorSource});break;case h.ERROR_MWS_BAD_AUDIO_OR_VIDEO_DATA:this.$LiveVideoBroadcastLoggingStore1(b("LiveVideoBroadcastWaterfallEvent").UI_MWS_BAD_AUDIO_OR_VIDEO_DATA,null,null);break;case h.ERROR_TRACK_ENDED:this.$LiveVideoBroadcastLoggingStore1(b("LiveVideoBroadcastWaterfallEvent").UI_TRACK_ENDED,null,null);b("LiveVideoBroadcastFunnelLogger").trackEnded();break;case h.SETUP_UFI:this.$LiveVideoBroadcastLoggingStore1(b("LiveVideoBroadcastWaterfallEvent").UI_UFI_LOADED,null,null);break;case h.UI_MOUNTED:b("LiveVideoBroadcastFunnelLogger").updateSourceTag();break;case h.READY_STATE_ENDED:this.$LiveVideoBroadcastLoggingStore1(b("LiveVideoBroadcastWaterfallEvent").UI_READY_STATE_ENDED,null,null);break;case h.API_BROADCAST_STOPPED:this.$LiveVideoBroadcastLoggingStore1(b("LiveVideoBroadcastWaterfallEvent").API_BROADCAST_STOPPED,null,null);break;case h.SET_INPUT_SOURCE:this.$LiveVideoBroadcastLoggingStore1(b("LiveVideoBroadcastWaterfallEvent").UI_SET_INPUT_SOUCE,null,{source:c.source});b("LiveVideoBroadcastFunnelLogger").setInputSource(c.source);break;case h.API_GO_LIVE_CLICKED:g=b("LiveVideoBroadcastUIStore").get("composerConfig");f=g?b("LiveVideoBroadcastUtils").getComposerFormData(g.contextConfig.composerID,g.config.targetData.targetID,g.config.contextInfo):{};this.$LiveVideoBroadcastLoggingStore1(b("LiveVideoBroadcastWaterfallEvent").UI_GO_LIVE_CLICKED,null,babelHelpers["extends"]({},f,{crossposts_count:b("LiveVideoBroadcastCrosspostStore").getSelectedCrosspostPagesCount()}));b("LiveVideoBroadcastFunnelLogger").goLiveClicked();break;case h.SET_CONTENT_TAGS:this.$LiveVideoBroadcastLoggingStore1(b("LiveVideoBroadcastWaterfallEvent").UI_SET_CONTENT_TAGS,null,{content_tags:c.value.map(function(a){return a.getTitle()})});b("LiveVideoBroadcastFunnelLogger").setContentTags();break;case h.SET_BROADCAST_STATE:this.$LiveVideoBroadcastLoggingStore1(b("LiveVideoBroadcastWaterfallEvent").UI_SET_BROADCAST_STATE,null,{new_broadcast_state:c.broadcastState});b("LiveVideoBroadcastFunnelLogger").setBroadcastState(c.broadcastState);break;case h.ERROR_STARTING_API_BROADCAST:this.$LiveVideoBroadcastLoggingStore1(b("LiveVideoBroadcastWaterfallEvent").UI_ERROR_STARTING_API_BROADCAST,null,{errorType:c.errorType,additionalInfo:c.additionalInfo});b("LiveVideoBroadcastFunnelLogger").errorStartingAPIBroadcast();break;case h.SERVER_ERROR:this.$LiveVideoBroadcastLoggingStore1(b("LiveVideoBroadcastWaterfallEvent").SERVER_ERROR,null,{details:c.details});b("LiveVideoBroadcastFunnelLogger").errorStartingAPIBroadcast();break;case h.CLICK_FINISH_BUTTON:this.$LiveVideoBroadcastLoggingStore1(b("LiveVideoBroadcastWaterfallEvent").UI_CLICK_FINISH_BUTTON,null,null);this.$LiveVideoBroadcastLoggingStore4(b("VideoBroadcastLoggerEvent").CLICK_FINISH_BUTTON,i.LIVE,null);b("LiveVideoBroadcastFunnelLogger").clickFinishButton();break;case h.API_BROADCAST_LIVE_PREVIEW_PLAYING:this.$LiveVideoBroadcastLoggingStore1(b("LiveVideoBroadcastWaterfallEvent").UI_PREVIEW_PLAYING,null,null);break;case h.PREVIEW_PLAYER_CRASH:this.$LiveVideoBroadcastLoggingStore1(b("LiveVideoBroadcastWaterfallEvent").UI_PREVIEW_PLAYER_CRASH,null,{playerError:c.errorInfo});break}return a};a.prototype.$LiveVideoBroadcastLoggingStore3=function(){var a=document.createElement("canvas");a=a.getContext("webgl")||a.getContext("experimental-webgl");this.$LiveVideoBroadcastLoggingStore1(b("LiveVideoBroadcastWaterfallEvent").UI_GO_LIVE_CLICKED,null,{webglEnabled:a!=null});b("LiveVideoBroadcastFunnelLogger").goLiveClicked()};a.prototype.$LiveVideoBroadcastLoggingStore4=function(event,a,c){this.getDispatcher().waitFor([b("LiveVideoBroadcastIDStore").getDispatchToken(),b("LiveVideoBroadcastUIStore").getDispatchToken()]);var d=b("LiveVideoBroadcastIDStore").get("broadcastID"),e=b("LiveVideoBroadcastUIStore").getState().toObject();e=e.broadcastState;if(a&&a!==e)return;a=new(b("VideoBroadcastTypedLogger"))().setOverrideVideoBroadcastID(d).setOverrideAppID(b("LiveVideoBroadcastConstants").LIVE_WWW_BROADCASTING_APP_ID).setBroadcastEvent(event);c&&a.updateExtraData(c);a.log()};a.prototype.$LiveVideoBroadcastLoggingStore2=function(event){__p&&__p();var a=b("Video360LiveCameraNames").camera_names;for(var c=0;c<a.length;c++)a[c]=a[c].toLowerCase();c=b("LiveVideoBroadcastBroadcastStore").getState().toObject();var d=c.broadcastId;c=c.videoId;var e=b("RTCMediaDevicesStore").getState();if(!e)return;var f=b("RTCUserSettingsStore").getState(),g=f.videoInput;if(event==="go_live"){f=e.find(function(a){return a.deviceId===g});f&&(f=this.$LiveVideoBroadcastLoggingStore5(f.label),a.indexOf(f.toLowerCase())>-1&&new(b("Live360CameraStateTypedLogger"))().setEvent(event).setVideoID(c).setCameraName(f).setVC(b("CurrentUser").getAccountID()).setBroadcastID(d).log())}else if(event==="connected"){e=e.filter(function(a){return a.kind==="videoinput"});for(var h=0;h<e.length;h++)f=this.$LiveVideoBroadcastLoggingStore5(e[h].label),a.indexOf(f.toLowerCase())>-1&&new(b("Live360CameraStateTypedLogger"))().setEvent(event).setVideoID(c).setCameraName(f).setVC(b("CurrentUser").getAccountID()).setBroadcastID(d).log()}};a.prototype.$LiveVideoBroadcastLoggingStore1=function(event,a,c,d){__p&&__p();this.getDispatcher().waitFor([b("LiveVideoBroadcastUIStore").getDispatchToken()]);var e=b("LiveVideoBroadcastBroadcastStore").getState().toObject(),f=e.broadcastId;e=e.videoId;var g=b("LiveVideoBroadcastAPIBroadcastStore").get("apiBroadcastID"),h=b("LiveVideoBroadcastBroadcastStore").getCurrentBroadcastTime();h=h===0?null:h;var i=b("LiveVideoBroadcastUIStore").getState().toObject(),j=i.broadcastState,k=i.wasEverOffline;i=i.inputSource;if(a&&a!==j)return;a=new(b("LiveVideoBroadcastWaterfallTypedLogger"))().setBroadcastID(f).setAPIBroadcastID(g).setBroadcastDuration(h).setSessionID(this.get("sessionID")).setWasUserOffline(k).setIceConnectionState(this.get("iceConnectionState")).setNewIceConnectionState(d).setVideoID(e).setBroadcastState(j).setInputSource(i).setEvent(event);c&&a.updateExtraData(c);a.log()};a.prototype.$LiveVideoBroadcastLoggingStore5=function(a){a=a.split(" ");var b=a.length;b>1&&a[b-1][0]=="("&&b--;return a.slice(0,b).join(" ")};function a(){g.apply(this,arguments)}a.__moduleID=e.id;e.exports=new a(b("LiveVideoBroadcastDispatcher"))}),null);