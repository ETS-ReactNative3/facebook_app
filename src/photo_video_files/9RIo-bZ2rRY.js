if (self.CavalryLogger) { CavalryLogger.start_js(["m37O5"]); }

__d("FeedFundraiserToCharityAttachmentStyle",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({BORDERLESS:"borderless",BOX:"box"})}),null);
__d("LiveInviteFriendsResultRow.react",["ix","cx","fbt","Image.react","InlineBlock.react","Layout.react","LiveVideoBroadcastActions","ProfileTile.react","React","XUIButton.react","fbglyph"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k=b("Layout.react").Column,l=b("Layout.react").FillColumn;c=babelHelpers.inherits(a,b("React").Component);j=c&&c.prototype;function a(){var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=j.constructor).call.apply(a,[this].concat(e)),this.$1=function(event){b("LiveVideoBroadcastActions").inviteFriend({invitedFriendID:this.props.friendID,videoID:this.props.videoID})}.bind(this),c}a.prototype.render=function(){var a=b("React").createElement(b("Image.react"),{src:g("113341")}),c=b("React").createElement(b("Image.react"),{src:g("112967")}),d=i._("Invited");c=this.props.friendInvited?b("React").createElement(b("XUIButton.react"),{className:"_3b8a","data-hover":"tooltip","data-tooltip-content":d,disabled:!0,image:c,label:d}):b("React").createElement(b("XUIButton.react"),{className:"_3b8a",image:a,label:i._("Invite"),onClick:this.$1});return b("React").createElement(b("Layout.react"),null,b("React").createElement(k,{className:"_2kji"},b("React").createElement(b("ProfileTile.react"),{id:this.props.friendID,shouldShowProfileCardOnHover:!1,size:32})),b("React").createElement(l,null,b("React").createElement(b("InlineBlock.react"),{alignv:"middle",height:56},this.props.friendName)),b("React").createElement(k,{className:"_3b8b"},b("React").createElement(b("InlineBlock.react"),{alignv:"middle",height:28},c)))};e.exports=a}),null);
__d("LiveInviteFriendsResultList.react",["cx","fbt","LiveInviteFriendsResultRow.react","React"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=babelHelpers.inherits(a,b("React").Component);i=c&&c.prototype;function a(a){i.constructor.call(this,a),this.$1=h._("No results found")}a.prototype.render=function(){if(this.props.friendList.length===0)return b("React").createElement("div",{className:"_12xf"},this.$1);var a=this.props.friendList.map(function(a){return b("React").createElement("li",{className:"_2kjh",key:a.id},this.$2(a))}.bind(this));return b("React").createElement("ul",{className:"_2kjg"},a)};a.prototype.$2=function(a){var c=this.props.invitedFriendIDs.indexOf(a.id)>=0;return b("React").createElement(b("LiveInviteFriendsResultRow.react"),{friendID:a.id,friendInvited:c,friendName:a.name,videoID:this.props.videoID})};e.exports=a}),null);
__d("LiveVideoInviteFriendsDialog.react",["ix","cx","fbt","CurrentUser","FlexLayout.react","Image.react","InlineBlock.react","Link.react","LiveInviteFriendsResultList.react","LiveVideoBroadcastActions","React","SearchableTextInput.react","WebAsyncSearchSource","XUIButton.react","asset"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j;c=babelHelpers.inherits(a,b("React").PureComponent);j=c&&c.prototype;function a(a){j.constructor.call(this,a),this.$1=new(b("WebAsyncSearchSource"))({bootstrapRequests:[{data:{filter:["user"],options:["friends_only"],viewer:b("CurrentUser").getID()},uri:"/ajax/typeahead/first_degree.php"}]})}a.prototype.$2=function(a){b("LiveVideoBroadcastActions").setInviteFriendsQuery(a.target.value)};a.prototype.$3=function(a){a=a.slice(0,25).filter(function(a){return a.getUniqueID()!==b("CurrentUser").getID()}),b("LiveVideoBroadcastActions").setInviteFriendsSearchResults(a)};a.prototype.$4=function(){return this.props.inviteFriendsQueryString===""?this.props.inviteFriendsSuggestions:this.props.inviteFriendsQueryResults.map(function(a){return{id:a.getUniqueID(),name:a.getTitle()}})};a.prototype.$5=function(){b("LiveVideoBroadcastActions").setInviteFriendsShown(!1)};a.prototype.render=function(){var a=b("React").createElement("div",{className:"_ftk"},b("React").createElement(b("InlineBlock.react"),{alignv:"middle",className:"_4zd3",height:40},this.props.inviteFriendsTitle),b("React").createElement(b("Link.react"),{className:"_2wks",onClick:this.$5},b("React").createElement(b("Image.react"),{src:g("493873")}))),c=b("React").createElement("div",{className:"_ftl"},b("React").createElement(b("SearchableTextInput.react"),{className:"_4zd4",placeholder:this.props.placeholderText,queryString:this.props.inviteFriendsQueryString,ref:function(a){a!=null&&a.focusInput()},searchOnUpdate:!0,searchSource:this.$1,onChange:this.$2,onEntriesFound:this.$3})),d=this.$4();d=b("React").createElement(b("LiveInviteFriendsResultList.react"),{friendList:d,invitedFriendIDs:this.props.invitedFriendIDs,videoID:this.props.videoId});d=b("React").createElement("div",{className:"_ftm"},d);var e=b("React").createElement(b("XUIButton.react"),{label:i._("Done"),size:"large",use:"confirm",onClick:this.$5});e=b("React").createElement(b("FlexLayout.react"),{align:"center",className:"_fto",justify:"end"},b("React").createElement("div",{className:"_ftp"},e));return b("React").createElement("div",{className:"_1yda"},a,c,d,e)};e.exports=a}),null);
__d("LiveInviteNotifContext",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({API:"api",CHAT:"chat",WWW_UI:"www_ui",WAVE:"wave",TEST:"test",UNKNOWN:"unknown"})}),null);
__d("LiveVideoInvitedFriendsQueryWebGraphQLQuery",["WebGraphQLQueryBase"],(function(a,b,c,d,e,f){"use strict";__p&&__p();e.exports=function(){__p&&__p();var a;a=babelHelpers.inherits(c,b("WebGraphQLQueryBase"));a&&a.prototype;c.__getDocID=function(){"use strict";return"1399791376742292"};c.getQueryID=function(){"use strict";return"725846884272464"};function c(){"use strict";a.apply(this,arguments)}return c}()}),null);
__d("LiveVideoInviteFriendsDataManager",["LiveVideoBroadcastActions","LiveVideoInvitedFriendsQueryWebGraphQLQuery","WebGraphQL","compactArray","promiseDone"],(function(a,b,c,d,e,f){"use strict";a={fetchInvitedFriends:function(a){b("promiseDone")(b("WebGraphQL").exec(new(b("LiveVideoInvitedFriendsQueryWebGraphQLQuery"))({node_id:a})),function(a){a=((a=a)!=null?(a=a.node)!=null?a.already_invited_live_viewers:a:a)||[];a=b("compactArray")(a.map(function(a){return a.id}));b("LiveVideoBroadcastActions").setInvitedFriends(a)})}};e.exports=a}),null);
__d("XLiveVideoInviteFriendsController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/live_video/invite_friends/",{friend_ids:{type:"FBIDVector"},video_id:{type:"FBID"},source:{type:"Enum",defaultValue:"unknown",enumType:1}})}),null);
__d("LiveVideoInviteFriendsStore",["AsyncRequest","FBLogger","FluxMapStore","LiveInviteNotifContext","LiveVideoBroadcastConstants","LiveVideoBroadcastDispatcher","LiveVideoInviteFriendsDataManager","XLiveVideoInviteFriendsController","immutable"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=b("LiveVideoBroadcastConstants").ACTIONS;g=babelHelpers.inherits(a,b("FluxMapStore"));g&&g.prototype;a.prototype.getInitialState=function(){return b("immutable").Map({invitedFriendIDs:[],inviteFriendsQueryResults:[],inviteFriendsQueryString:"",inviteFriendsSuggestions:[],inviteFriendsShown:!1})};a.prototype.reduce=function(a,c){__p&&__p();switch(c.type){case h.INITIALIZE:case h.CLEANUP:a=this.getInitialState();break;case h.FINISH_BROADCAST_REQUEST:a=a.set("inviteFriendsShown",!1);break;case h.SET_INVITE_FRIENDS_SHOWN:a=a.set("inviteFriendsShown",c.value);c.value||(a=a.set("inviteFriendsQueryResults",[]).set("inviteFriendsQueryString",""));break;case h.SET_INVITE_FRIENDS_QUERY:a=a.set("inviteFriendsQueryString",c.value.inviteFriendsQueryString);break;case h.INVITE_FRIEND:var d=c.value.invitedFriendID,e=c.value.videoID;e||b("FBLogger")("live_video").warn("Attempting to invite to invalid videoID");e=b("XLiveVideoInviteFriendsController").getURIBuilder().setFBID("video_id",e).setFBIDVector("friend_ids",[d]).setEnum("source",b("LiveInviteNotifContext").WWW_UI).getURI();new(b("AsyncRequest"))(e).setHandler(function(a){}).setErrorHandler(function(a){}).send();a=a.set("invitedFriendIDs",a.get("invitedFriendIDs").concat([d]));break;case h.SET_INVITE_FRIENDS_RESULTS:a=a.set("inviteFriendsQueryResults",c.value.results);break;case h.SET_INVITE_FRIENDS_SUGGESTIONS:a=a.set("inviteFriendsSuggestions",c.value.results);break;case h.FETCH_INVITED_FRIENDS:b("LiveVideoInviteFriendsDataManager").fetchInvitedFriends(c.value);break;case h.SET_INVITED_FRIENDS:a=a.set("invitedFriendIDs",a.get("invitedFriendIDs").concat(c.value.friendIds));break;default:break}return a};function a(){g.apply(this,arguments)}a.__moduleID=e.id;e.exports=new a(b("LiveVideoBroadcastDispatcher"))}),null);
__d("LiveVideoInviteFriendsDialogContainer.react",["fbt","FluxContainer","LiveVideoBroadcastActions","LiveVideoBroadcastDispatcher","LiveVideoInviteFriendsDialog.react","LiveVideoInviteFriendsStore","React"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=babelHelpers.inherits(a,b("React").Component);h=c&&c.prototype;function a(a){h.constructor.call(this,a),this.state={inviteFriendsQueryString:"",inviteFriendsQueryResults:[],invitedFriendIDs:[],inviteFriendsSuggestions:[],inviteFriendsShown:!1},b("LiveVideoBroadcastDispatcher").explicitlyRegisterStores([b("LiveVideoInviteFriendsStore")]),b("LiveVideoBroadcastActions").fetchInviteFriendsSuggestions(),b("LiveVideoBroadcastActions").fetchInvitedFriends(this.props.videoId)}a.getStores=function(){return[b("LiveVideoInviteFriendsStore")]};a.calculateState=function(){var a=b("LiveVideoInviteFriendsStore").getState().toObject(),c=a.invitedFriendIDs,d=a.inviteFriendsQueryResults,e=a.inviteFriendsQueryString,f=a.inviteFriendsSuggestions;a=a.inviteFriendsShown;return{invitedFriendIDs:c,inviteFriendsQueryResults:d,inviteFriendsQueryString:e,inviteFriendsSuggestions:f,inviteFriendsShown:a}};a.prototype.render=function(){if(!this.state.inviteFriendsShown)return null;var a=g._("Search");return b("React").createElement(b("LiveVideoInviteFriendsDialog.react"),{inviteFriendsQueryResults:this.state.inviteFriendsQueryResults,inviteFriendsQueryString:this.state.inviteFriendsQueryString,inviteFriendsSuggestions:this.state.inviteFriendsSuggestions,inviteFriendsTitle:this.props.inviteFriendsTitle,invitedFriendIDs:this.state.invitedFriendIDs,placeholderText:a,videoId:this.props.videoId})};e.exports=b("FluxContainer").create(a)}),null);
__d("LiveVideoCheckCurrentlyWatchingViewersQueryWebGraphQLQuery",["WebGraphQLQueryBase"],(function(a,b,c,d,e,f){"use strict";__p&&__p();e.exports=function(){__p&&__p();var a;a=babelHelpers.inherits(c,b("WebGraphQLQueryBase"));a&&a.prototype;c.__getDocID=function(){"use strict";return"1380660238708407"};c.getQueryID=function(){"use strict";return"1459882240979983"};function c(){"use strict";a.apply(this,arguments)}return c}()}),null);
__d("LiveVideoCurrentlyWatchingEvent",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({JOIN:"join",LEAVE:"leave"})}),null);
__d("LiveVideoCurrentlyWatchingSubscriptionWebGraphQLSubscription",["WebGraphQLSubscriptionHelper"],(function(a,b,c,d,e,f){"use strict";e.exports=b("WebGraphQLSubscriptionHelper").getExports({docID:"1424207670935230",queryID:"749242881906644"})}),null);
__d("LiveVideoCurrentlyWatchingSubscription",["BaseGraphQLSubscription","LiveVideoCurrentlyWatchingSubscriptionWebGraphQLSubscription","uuid"],(function(a,b,c,d,e,f){a=babelHelpers["extends"]({},b("BaseGraphQLSubscription"),{_getTopic:function(a){return"gqls/live_video_currently_watching_subscribe/video_id_"+a},_getQueryID:function(){return b("LiveVideoCurrentlyWatchingSubscriptionWebGraphQLSubscription").getDocID()},_getQueryParameters:function(a){return{data:JSON.stringify({client_subscription_id:b("uuid")(),video_id:a})}},_getSubscriptionCallName:function(){return"live_video_currently_watching_subscribe"}});e.exports=a}),null);
__d("UFILiveViewersRow.react",["ix","cx","Facepile.react","FlexLayout.react","Image.react","LeftFillRightFitLayout.react","LiveVideoBroadcastActions","ProfileBrowserLink","ProfileBrowserTypes","React","XUIButton.react","fbglyph"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j=5,k=function(a){var c=b("React").createElement(b("Image.react"),{src:g("113342")});return b("React").createElement(b("XUIButton.react"),{className:"_62ln",image:c,label:"Invite",labelIsHidden:!0,size:"medium",onClick:a.onInviteFriendsButtonClick,type:"button"})},l=function(a){return!a.shouldShowInviteButton?null:b("React").createElement(b("FlexLayout.react"),{className:(a.shouldScrollToRow?"":"_62lo")+(a.shouldScrollToRow?" _1dkf":""),align:"center"},b("React").createElement(k,a),b("React").createElement(b("FlexLayout.react"),{className:"_62lp",align:"center"},a.inviteFriendsTitle))};i=babelHelpers.inherits(a,b("React").Component);i&&i.prototype;a.prototype.$1=function(){b("LiveVideoBroadcastActions").setInviteFriendsShown(!0)};a.prototype.render=function(){__p&&__p();var a=this.props.viewers;if(!a.length)return b("React").createElement(l,{shouldShowInviteButton:this.props.shouldShowInviteButton,onInviteFriendsButtonClick:this.$1,shouldScrollToRow:this.props.shouldScrollToRow,inviteFriendsTitle:this.props.inviteFriendsTitle});var c=a.length>j?a.slice(0,j-1):a;a=a.length>j?1+a.length-j:0;var d=b("ProfileBrowserTypes").LIVE_VIDEO_VIEWERS,e={video_id:this.props.videoId},f=b("ProfileBrowserLink").constructDialogURI(d,e);d=b("ProfileBrowserLink").constructPageURI(d,e);e=b("React").createElement(b("Facepile.react"),{moreColor:"blue",moreCount:a,moreDialogLink:f.toString(),morePageLink:d.toString(),profiles:c,size:"medium"});a=b("React").createElement("a",{ajaxify:f,href:d,rel:"dialog"},this.props.title);return this.props.shouldShowInviteButton?b("React").createElement(b("FlexLayout.react"),{className:(this.props.shouldScrollToRow?"":"_62lo")+(this.props.shouldScrollToRow?" _1dkf":""),align:"center"},b("React").createElement(k,{onInviteFriendsButtonClick:this.$1}),b("React").createElement(b("FlexLayout.react"),{className:"_3-99",align:"center"},e,b("React").createElement("div",{className:"_3-99"},a))):b("React").createElement(b("LeftFillRightFitLayout.react"),{className:"_17ab"},b("React").createElement("div",{className:"_2z2j"},a),e)};function a(){i.apply(this,arguments)}e.exports=a}),null);
__d("VideoBroadcastWhosWatchingTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(){this.clear()}a.prototype.log=function(){b("GeneratedLoggerUtils").log("logger:VideoBroadcastWhosWatchingLoggerConfig",this.$1,b("Banzai").BASIC)};a.prototype.logVital=function(){b("GeneratedLoggerUtils").log("logger:VideoBroadcastWhosWatchingLoggerConfig",this.$1,b("Banzai").VITAL)};a.prototype.logImmediately=function(){b("GeneratedLoggerUtils").log("logger:VideoBroadcastWhosWatchingLoggerConfig",this.$1,{signal:!0})};a.prototype.clear=function(){this.$1={};return this};a.prototype.getData=function(){return babelHelpers["extends"]({},this.$1)};a.prototype.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};a.prototype.setEntityPresenceExtra=function(a){this.$1.entity_presence_extra=b("GeneratedLoggerUtils").serializeVector(a);return this};a.prototype.setPollingExtra=function(a){this.$1.polling_extra=b("GeneratedLoggerUtils").serializeVector(a);return this};a.prototype.setSubscriptionExtra=function(a){this.$1.subscription_extra=b("GeneratedLoggerUtils").serializeVector(a);return this};a.prototype.setVideoID=function(a){this.$1.video_id=a;return this};c={entity_presence_extra:!0,polling_extra:!0,subscription_extra:!0,video_id:!0};e.exports=a}),null);
__d("UFILiveViewersRowContainer.react",["AsyncRequest","LiveVideoCheckCurrentlyWatchingViewersQueryWebGraphQLQuery","LiveVideoCurrentlyWatchingEvent","LiveVideoCurrentlyWatchingSubscription","LiveVideoCurrentlyWatchingViewersQueryWebGraphQLQuery","Poller","React","UFILiveViewersRow.react","VideoBroadcastStatus","VideoBroadcastWhosWatchingTypedLogger"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=5,i=2e4,j=1e4;c=babelHelpers.inherits(a,b("React").Component);g=c&&c.prototype;function a(a){g.constructor.call(this,a),this.state={viewers:[]},this.$1=0,this.$4=[]}a.prototype.UNSAFE_componentWillMount=function(){this.$5(this.props),this.$6(this.props)};a.prototype.componentWillUnmount=function(){this.$7(),this.$8()};a.prototype.UNSAFE_componentWillReceiveProps=function(a){a.videoId!==this.props.videoId&&(this.$5(a),this.$6(a))};a.prototype.render=function(){return b("React").createElement(b("UFILiveViewersRow.react"),{title:this.props.title,videoId:this.props.videoId,viewers:this.state.viewers,shouldShowInviteButton:this.props.shouldShowInviteButton,shouldScrollToRow:this.props.shouldScrollToRow,inviteFriendsTitle:this.props.inviteFriendsTitle})};a.prototype.$6=function(a){__p&&__p();this.$7(),this.$1=0,this.$2=new(b("Poller"))({setupRequest:function(c,d){this.$4.length===0&&d.skip();var e=Date.now(),f=this.$4.filter(function(a){return e-a.timeJoined>j}).map(function(a){return a.uniqueID});d=b("LiveVideoCheckCurrentlyWatchingViewersQueryWebGraphQLQuery").getURI({video_id:a.videoId,viewer_ids:f});c.setURI(d).setHandler(function(a){return this.$9(a,f)}.bind(this)).setErrorHandler(function(a){return this.$10()}.bind(this))}.bind(this),interval:function(){return i*(this.$1+1)}.bind(this)})};a.prototype.$7=function(){this.$2&&this.$2.stop()};a.prototype.$11=function(){this.setState({viewers:[]}),this.$7()};a.prototype.$10=function(){this.setState({viewers:[]}),this.$1++,this.$1==h&&this.$7()};a.prototype.$12=function(a){return a.map(function(a){return{name:a.name,uniqueID:a.uniqueID,profilePicURI:a.profilePicURI,URL:a.URL}})};a.prototype.$13=function(a){if(a.length!==this.$4.length)return!0;else for(var b=0;b<a.length;b++)if(a[b].uniqueID!==this.$4[b].uniqueID)return!0;return!1};a.prototype.$5=function(a){var c=b("LiveVideoCurrentlyWatchingViewersQueryWebGraphQLQuery").getURI({video_id:a.videoId});new(b("AsyncRequest"))(c).setHandler(function(a){return this.$14(a)}.bind(this)).send();this.$3=b("LiveVideoCurrentlyWatchingSubscription").subscribe(a.videoId,function(a){this.$15(a)}.bind(this))};a.prototype.$8=function(){this.$3&&this.$3.unsubscribe()};a.prototype.$16=function(a){if(!a){this.$10();return!1}return a.broadcast_status!==b("VideoBroadcastStatus").LIVE&&a.broadcast_status!==b("VideoBroadcastStatus").PREVIEW?!1:!0};a.prototype.$14=function(a){__p&&__p();a=a.payload.data.video;if(!this.$16(a)){this.$11();return}a=a.live_video_current_viewers.edges||[];var b=[];a.forEach(function(a){a=a.node;var c=a.id,d=a.name,e=(a.profile_picture||{}).uri,f=a.viewer_affinity;c&&d&&e&&b.push({name:d,uniqueID:c,profilePicURI:e,URL:a.url,rank:f,timeJoined:Date.now()})});this.$13(b)&&(this.$4=b,this.setState({viewers:this.$12(b)}))};a.prototype.$9=function(a,c){__p&&__p();a=a.payload.data.video;if(!this.$16(a)){this.$11();return}a=a.live_video_check_current_viewers.edges||[];var d=[];a.forEach(function(a){a=a.node;a=a.id;a&&d.push(a)});var e=[];a=this.$4.filter(function(a){if(d.indexOf(a.uniqueID)===-1&&c.indexOf(a.uniqueID)!==-1){e.push(a.uniqueID);return!1}else return!0});new(b("VideoBroadcastWhosWatchingTypedLogger"))().setPollingExtra().setSubscriptionExtra(e).setVideoID(this.props.videoId).log();this.$13(a)&&(this.$4=a,this.setState({viewers:this.$12(a)}))};a.prototype.$15=function(a){__p&&__p();var c=a.live_video_currently_watching_subscribe.watcher,event=a.live_video_currently_watching_subscribe.event;a=c.id;var d=c.name,e=(c.profile_picture||{}).uri;if(!a||!d||!e)return;d={name:d,uniqueID:a,profilePicURI:e,URL:c.url,rank:c.viewer_affinity,timeJoined:Date.now()};a=this.$4;e=a.length;switch(event){case b("LiveVideoCurrentlyWatchingEvent").JOIN:if(e===0){a.push(d);break}c=0;for(var f=0;f<e;f++){a[f].rank>=d.rank&&(c=f+1);if(a[f].uniqueID===d.uniqueID)return}a.splice(c,0,d);break;case b("LiveVideoCurrentlyWatchingEvent").LEAVE:if(e===0)return;for(var f=0;f<e;f++)if(a[f].uniqueID===d.uniqueID){a.splice(f,1);break}break}this.$4=a;this.setState({viewers:this.$12(a)})};e.exports=a}),null);
__d("LiveVideoWhosWatchingActionTypes",["keyMirrorRecursive"],(function(a,b,c,d,e,f){a={CHECK_QUERY_ERROR:"",INIT:"",STOP:"",VIEWER_JOIN:"",VIEWER_LEAVE:""};c=b("keyMirrorRecursive")(a);e.exports=c}),null);
__d("LiveVideoWhosWatchingActions",["LiveVideoWhosWatchingActionTypes","TahoeDispatcher"],(function(a,b,c,d,e,f){a={init:function(a){b("TahoeDispatcher").dispatch({type:b("LiveVideoWhosWatchingActionTypes").INIT,videoId:a})},stop:function(a){b("TahoeDispatcher").dispatch({type:b("LiveVideoWhosWatchingActionTypes").STOP,videoId:a})},viewerJoin:function(a,c){b("TahoeDispatcher").dispatch({type:b("LiveVideoWhosWatchingActionTypes").VIEWER_JOIN,videoId:a,viewer:c})},viewerLeave:function(a,c){b("TahoeDispatcher").dispatch({type:b("LiveVideoWhosWatchingActionTypes").VIEWER_LEAVE,videoId:a,viewerId:c})},handleCheckQueryError:function(a){b("TahoeDispatcher").dispatch({type:b("LiveVideoWhosWatchingActionTypes").CHECK_QUERY_ERROR,videoId:a})}};e.exports=a}),null);
__d("LiveVideoWhosWatchingDataManager",["AsyncRequest","LiveVideoCurrentlyWatchingEvent","LiveVideoCurrentlyWatchingSubscription","LiveVideoCurrentlyWatchingViewersQueryWebGraphQLQuery","LiveVideoWhosWatchingActions","VideoBroadcastStatus","VideoBroadcastWhosWatchingTypedLogger","requireWeak"],(function(a,b,c,d,e,f){__p&&__p();function g(a,c){c.length>0&&b("requireWeak")("UFILiveStreamingComments",function(b){b.enqueueLiveJoinEventComment(a,c)})}var h={bootstrapQuery:function(a){var c=b("LiveVideoCurrentlyWatchingViewersQueryWebGraphQLQuery").getURI({video_id:a});new(b("AsyncRequest"))(c).setHandler(function(b){return h.handleLiveViewerQuery(a,b)}).send()},subscribe:function(a){return b("LiveVideoCurrentlyWatchingSubscription").subscribe(a,function(b){h.handleSubscriptionPayload(a,b)})},isValidBroadcastStatus:function(a){return a.broadcast_status===b("VideoBroadcastStatus").LIVE||a.broadcast_status===b("VideoBroadcastStatus").PREVIEW},handleLiveViewerQuery:function(a,c){__p&&__p();c=c.payload.data.video;if(!h.isValidBroadcastStatus(c))return;c=c.live_video_current_viewers.edges||[];var d=[];c.forEach(function(c){c=c.node;var e=c.id,f=c.name,g=(c.profile_picture||{}).uri,h=c.viewer_affinity;if(e&&f&&g){f={name:f,uniqueID:e,profilePicURI:g,URL:c.url,rank:h,timeJoined:Date.now()};b("LiveVideoWhosWatchingActions").viewerJoin(a,f);d.push(f)}});g(a,d)},handleSubscriptionPayload:function(a,c){__p&&__p();var d=c.live_video_currently_watching_subscribe.watcher,event=c.live_video_currently_watching_subscribe.event;c=d.id;var e=d.name,f=(d.profile_picture||{}).uri;if(!c||!e||!f)return;e={name:e,uniqueID:c,profilePicURI:f,URL:d.url,rank:d.viewer_affinity,timeJoined:Date.now()};switch(event){case b("LiveVideoCurrentlyWatchingEvent").JOIN:b("LiveVideoWhosWatchingActions").viewerJoin(a,e);g(a,[e]);break;case b("LiveVideoCurrentlyWatchingEvent").LEAVE:b("LiveVideoWhosWatchingActions").viewerLeave(a,e.uniqueID);break}},handleCheckLiveViewerQuery:function(a,c,d){__p&&__p();a=a.payload.data.video;if(!h.isValidBroadcastStatus(a))return;a=a.live_video_check_current_viewers.edges||[];var e=[];a.forEach(function(a){a=a.node;a=a.id;a&&e.push(a)});a=d.filter(function(a){if(e.indexOf(a)===-1){b("LiveVideoWhosWatchingActions").viewerLeave(c,a);return!0}return!1}).map(function(a){a.toString()});new(b("VideoBroadcastWhosWatchingTypedLogger"))().setPollingExtra().setSubscriptionExtra(a).setVideoID(c).log()},handleCheckQueryError:function(a){b("LiveVideoWhosWatchingActions").handleCheckQueryError(a)}};e.exports=h}),null);
__d("LiveVideoWhosWatchingStore",["AsyncRequest","FluxMapStore","LiveVideoCheckCurrentlyWatchingViewersQueryWebGraphQLQuery","LiveVideoWhosWatchingActionTypes","LiveVideoWhosWatchingDataManager","Poller","TahoeDispatcher","immutable"],(function(a,b,c,d,e,f){__p&&__p();var g,h;g=babelHelpers.inherits(i,b("immutable").Record({rankedViewers:[],viewers:[]}));g&&g.prototype;function i(){"use strict";g.apply(this,arguments)}var j=1e4,k=2e4,l=5;h=babelHelpers.inherits(a,b("FluxMapStore"));h&&h.prototype;a.prototype.reduce=function(a,c){"use strict";__p&&__p();switch(c.type){case b("LiveVideoWhosWatchingActionTypes").CHECK_QUERY_ERROR:a=this.$LiveVideoWhosWatchingStore4(a,c.videoId);break;case b("LiveVideoWhosWatchingActionTypes").INIT:b("LiveVideoWhosWatchingDataManager").bootstrapQuery(c.videoId);this.$LiveVideoWhosWatchingStore2=b("LiveVideoWhosWatchingDataManager").subscribe(c.videoId);this.$LiveVideoWhosWatchingStore5(a,c.videoId);break;case b("LiveVideoWhosWatchingActionTypes").STOP:this.$LiveVideoWhosWatchingStore6();this.$LiveVideoWhosWatchingStore7();a=a.remove(c.videoId);break;case b("LiveVideoWhosWatchingActionTypes").VIEWER_JOIN:a=this.$LiveVideoWhosWatchingStore8(a,c.videoId,c.viewer);break;case b("LiveVideoWhosWatchingActionTypes").VIEWER_LEAVE:a=this.$LiveVideoWhosWatchingStore9(a,c.videoId,c.viewerId);break;default:break}return a};a.prototype.$LiveVideoWhosWatchingStore10=function(){"use strict";return new i({rankedViewers:[],viewers:[]})};a.prototype.$LiveVideoWhosWatchingStore8=function(a,b,c){"use strict";__p&&__p();var d=a.get(b)||this.$LiveVideoWhosWatchingStore10();d=d.rankedViewers;var e=d.length;if(e===0)d.push(c);else{var f=0;for(var g=0;g<e;g++){d[g].rank>=c.rank&&(f=g+1);if(d[g].uniqueID===c.uniqueID)return a}d.splice(f,0,c)}return a.set(b,new i({rankedViewers:d,viewers:this.$LiveVideoWhosWatchingStore11(d)}))};a.prototype.$LiveVideoWhosWatchingStore9=function(a,b,c){"use strict";__p&&__p();var d=a.get(b);if(!d)return a;d=d.rankedViewers;var e=d.length;if(e===0)return a;for(var f=0;f<e;f++)if(d[f].uniqueID===c){d.splice(f,1);break}return a.set(b,new i({rankedViewers:d,viewers:this.$LiveVideoWhosWatchingStore11(d)}))};a.prototype.$LiveVideoWhosWatchingStore11=function(a){"use strict";return a.map(function(a){return{name:a.name,uniqueID:a.uniqueID,profilePicURI:a.profilePicURI,URL:a.URL}})};a.prototype.$LiveVideoWhosWatchingStore5=function(a,c){"use strict";__p&&__p();this.$LiveVideoWhosWatchingStore7(),this.$LiveVideoWhosWatchingStore3=0,this.$LiveVideoWhosWatchingStore1=new(b("Poller"))({setupRequest:function(a,d){__p&&__p();var e=this.getState().get(c);e=e?e.rankedViewers:[];e.length===0&&d.skip();var f=Date.now(),g=e.filter(function(a){return f-a.timeJoined>j}).map(function(a){return a.uniqueID});d=b("LiveVideoCheckCurrentlyWatchingViewersQueryWebGraphQLQuery").getURI({video_id:c,viewer_ids:g});a.setURI(d).setHandler(function(a){return b("LiveVideoWhosWatchingDataManager").handleCheckLiveViewerQuery(a,c,g)}).setErrorHandler(function(a){return b("LiveVideoWhosWatchingDataManager").handleCheckQueryError(c)})}.bind(this),interval:function(){return k*(this.$LiveVideoWhosWatchingStore3+1)}.bind(this)})};a.prototype.$LiveVideoWhosWatchingStore7=function(){"use strict";this.$LiveVideoWhosWatchingStore1&&this.$LiveVideoWhosWatchingStore1.stop()};a.prototype.$LiveVideoWhosWatchingStore4=function(a,b){"use strict";this.$LiveVideoWhosWatchingStore3++;this.$LiveVideoWhosWatchingStore3==l&&(a.remove(b),this.$LiveVideoWhosWatchingStore6(),this.$LiveVideoWhosWatchingStore7());return a};a.prototype.$LiveVideoWhosWatchingStore6=function(){"use strict";this.$LiveVideoWhosWatchingStore2&&this.$LiveVideoWhosWatchingStore2.unsubscribe()};function a(){"use strict";h.apply(this,arguments)}a.__moduleID=e.id;e.exports=new a(b("TahoeDispatcher"))}),null);
__d("UFILiveViewersRowStoreContainer.react",["FluxContainer","LiveVideoWhosWatchingActions","LiveVideoWhosWatchingStore","React","TahoeDispatcher","UFILiveViewersRow.react"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h={viewers:[]};c=babelHelpers.inherits(a,b("React").Component);g=c&&c.prototype;function a(a){b("TahoeDispatcher").explicitlyRegisterStores([b("LiveVideoWhosWatchingStore")]),g.constructor.call(this,a),this.state={viewers:[]}}a.getStores=function(){return[b("LiveVideoWhosWatchingStore")]};a.calculateState=function(a,c){a=b("LiveVideoWhosWatchingStore").getState().get(c.videoId);return a?{viewers:a.viewers}:h};a.prototype.componentDidMount=function(){b("LiveVideoWhosWatchingActions").init(this.props.videoId)};a.prototype.componentWillUnmount=function(){b("LiveVideoWhosWatchingActions").stop(this.props.videoId)};a.prototype.render=function(){return b("React").createElement(b("UFILiveViewersRow.react"),{title:this.props.title,videoId:this.props.videoId,viewers:this.state.viewers,shouldShowInviteButton:this.props.shouldShowInviteButton,shouldScrollToRow:this.props.shouldScrollToRow,inviteFriendsTitle:this.props.inviteFriendsTitle})};e.exports=b("FluxContainer").create(a,{withProps:!0})}),null);
__d("XLiveStreamingFundraiserAsyncController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/videos/fundraiser/",{eft_id:{type:"String",required:!0},style:{type:"Enum",defaultValue:"box",enumType:1}})}),null);
__d("XLiveStreamingSocialViewersAsyncController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/videos/socialviewers/",{eft_id:{type:"String",required:!0}})}),null);
__d("UFILiveStreamingController",["Arbiter","AsyncRequest","FeedFundraiserToCharityAttachmentStyle","LiveVideoInviteFriendsDialogContainer.react","React","ReactDOM","UFIAsyncWrapper","UFILiveViewersRowContainer.react","UFILiveViewersRowStoreContainer.react","XLiveStreamingFundraiserAsyncController","XLiveStreamingSocialViewersAsyncController","clearInterval","gkx","keyMirror","setInterval"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("keyMirror")({SOCIAL_VIEWERS:null,SOCIAL_VIEWERS_REACT:null,FUNDRAISER_BOX:null,FUNDRAISER_BORDERLESS:null,INVITE_DIALOG:null});h.initSocialViewers=function(a){return new h(a,g.SOCIAL_VIEWERS)};h.initSocialViewersReact=function(a,c,d,e,f,i,j){b("gkx")("AT5hL4ddeKh2EYcVaZo0PLd2qLLkzRfHeDMADXw3EHaIKcDb74UtuWMPVUrrkHIFlcLlEZCbudEtIXiL5Joo-BVS")?b("ReactDOM").render(b("React").createElement(b("UFIAsyncWrapper"),null,b("React").createElement(b("UFILiveViewersRowStoreContainer.react"),{inviteFriendsTitle:j,shouldShowInviteButton:f,shouldScrollToRow:i,title:c,videoId:a})),d):b("ReactDOM").render(b("React").createElement(b("UFIAsyncWrapper"),null,b("React").createElement(b("UFILiveViewersRowContainer.react"),{title:c,videoId:a,shouldShowInviteButton:f,shouldScrollToRow:i,inviteFriendsTitle:j})),d);return new h(a,g.SOCIAL_VIEWERS_REACT,d)};h.initSocialViewersInviteDialogReact=function(a,c,d){b("ReactDOM").render(b("React").createElement(b("UFIAsyncWrapper"),null,b("React").createElement(b("LiveVideoInviteFriendsDialogContainer.react"),{videoId:a,inviteFriendsTitle:d})),c);return new h(a,g.INVITE_DIALOG,c)};h.initFundraiser=function(a,b){return new h(a,g.FUNDRAISER_BOX,b)};h.initFundraiserBorderless=function(a,b){return new h(a,g.FUNDRAISER_BORDERLESS,b)};function h(a,c,d){__p&&__p();this.eftID=""+a;this.type=c;this.errorCount=0;this.rootElem=d;this.rootParentElem=d&&d.parentElement;var e=this.type===g.SOCIAL_VIEWERS||this.type===g.FUNDRAISER_BORDERLESS||this.type===g.FUNDRAISER_BOX;b("Arbiter").subscribe("VideoChannelView/closed",function(){this.stop()}.bind(this));b("Arbiter").subscribe("TahoeController/exitTahoe",function(){this.stop()}.bind(this));b("Arbiter").subscribe("PhotoSnowlift.CLOSE",function(){this.stop()}.bind(this));b("Arbiter").subscribe("VideoChannelView/activeStoryChanged",function(a,c){c.id===this.eftID?e&&(this.interval=b("setInterval")(function(){return this.update()}.bind(this),2e3)):this.stop()}.bind(this));e&&(this.update(),this.interval=b("setInterval")(function(){return this.update()}.bind(this),2e3))}h.prototype.update=function(){switch(this.type){case g.SOCIAL_VIEWERS:this.__updateSocialViewers();break;case g.SOCIAL_VIEWERS_REACT:case g.INVITE_DIALOG:break;case g.FUNDRAISER_BOX:this.__updateFundraiser(b("FeedFundraiserToCharityAttachmentStyle").BOX);break;case g.FUNDRAISER_BORDERLESS:this.__updateFundraiser(b("FeedFundraiserToCharityAttachmentStyle").BORDERLESS);break}};h.prototype.__updateSocialViewers=function(){__p&&__p();var a=b("XLiveStreamingSocialViewersAsyncController").getURIBuilder().setString("eft_id",this.eftID).getURI();new(b("AsyncRequest"))().setURI(a).setHandler(function(a){switch(a.payload.status){case"streaming":this.errorCount=0;return;case"not-streaming":this.stop();return;case"error":this.errorCount+=1;this.errorCount===5&&this.stop();return}}.bind(this)).send()};h.prototype.__updateFundraiser=function(a){__p&&__p();var c=this.rootParentElem&&this.rootParentElem.children[0];if(!c)return;a=b("XLiveStreamingFundraiserAsyncController").getURIBuilder().setString("eft_id",this.eftID).setEnum("style",a).getURI();new(b("AsyncRequest"))().setRelativeTo(c).setURI(a).setHandler(function(a){switch(a.payload.status){case"streaming":this.errorCount=0;return;case"not-streaming":this.stop();return;case"error":this.errorCount+=1;this.errorCount===5&&this.stop();return}}.bind(this)).send()};h.prototype.stop=function(){switch(this.type){case g.SOCIAL_VIEWERS_REACT:b("ReactDOM").unmountComponentAtNode(this.rootElem);break;case g.INVITE_DIALOG:b("ReactDOM").unmountComponentAtNode(this.rootElem);break;case g.SOCIAL_VIEWERS:case g.FUNDRAISER_BOX:case g.FUNDRAISER_BORDERLESS:b("clearInterval")(this.interval);break}};e.exports=h}),null);
__d("UFIReactionsLiveMenu.react",["cx","Arbiter","React","StreamingReactionsAnimationConfig","StreamingReactionsTrayEvents","UFICentralUpdates","UFIConstants","UFIDispatcher","UFIDispatcherContext.react","UFIFeedbackContext.react","UFIReactionsMenuWithStaticVectorIcons.react","UFIReactionStore","UFIStoryAction","VideoChannelViewVariables","VideoPlayerFormats"],(function(a,b,c,d,e,f,g){__p&&__p();var h,i=b("VideoChannelViewVariables").channelRedesign;c=babelHelpers.inherits(a,b("React").Component);h=c&&c.prototype;function a(){"use strict";h.constructor.call(this);var a=!0;this.$6=0;this.$3=b("StreamingReactionsAnimationConfig");this.$4=this.$3.THROTTLE.REACTION_CLICK_MUTATION_THRESHOLD;this.$5=-1;this.state={isReactionSelected:!1,isShown:a}}a.prototype.UNSAFE_componentWillMount=function(){"use strict";this.$1=new(b("UFIDispatcher"))(),this.$2={UFIReactionStore:new(b("UFIReactionStore"))(this.$1)},b("UFICentralUpdates").handleUpdate(b("UFIConstants").UFIPayloadSourceType.INITIAL_SERVER,this.props.payload),this.$7=b("Arbiter").subscribe(b("StreamingReactionsTrayEvents").HideChannelViewDetails,function(){this.setState({isShown:!1})}.bind(this)),this.$8=b("Arbiter").subscribe(b("StreamingReactionsTrayEvents").ShowChannelViewDetails,function(){this.setState({isShown:!0})}.bind(this))};a.prototype.componentWillUnmount=function(){"use strict";this.$2={},this.$1=null,b("Arbiter").unsubscribe(this.$8),b("Arbiter").unsubscribe(this.$7)};a.prototype.onReactionMouseDown=function(){"use strict";this.setState({isReactionSelected:!0})};a.prototype.onReactionMouseUp=function(){"use strict";this.setState({isReactionSelected:!1})};a.prototype.onReactionClick=function(a,event){"use strict";var c=Date.now(),d=c-this.$6;a!=this.$5||d>this.$4?(this.$1&&this.$1.dispatch(b("UFIStoryAction").changeReaction(this.props.contextArgs,a,event.target)),this.$6=c,this.$5=a):b("Arbiter").inform(b("StreamingReactionsTrayEvents").AddReactionAnimate,{reaction_type:a})};a.prototype.render=function(){"use strict";var a=this.props.contextArgs.player_format===b("VideoPlayerFormats").TAHOE,c=this.props.contextArgs.player_format===b("VideoPlayerFormats").FB_STORIES;return this.$1?b("React").createElement("div",{className:(this.state.isReactionSelected?"_3tiq":"")+(i?" _2dx7":"")+(a?" _41sw":"")+(c?" _1oxh":"")},b("React").createElement(b("UFIDispatcherContext.react"),{dispatcher:this.$1,stores:this.$2},b("React").createElement(b("UFIFeedbackContext.react"),{contextArgs:this.props.contextArgs,render:function(d,e){return b("React").createElement(b("UFIReactionsMenuWithStaticVectorIcons.react"),{allowKeyboardFocus:!1,initialReaction:e.viewerreaction,isLongPressing:!1,isScreenReader:!0,isDarkBackground:!c,noBackground:i||a||c,onMouseEnter:function(){},onMouseLeave:function(){},onReactionClick:function(a,event){this.onReactionClick(a,event)}.bind(this),onBlur:function(){},onFocus:function(){},onReactionMouseUp:this.onReactionMouseUp.bind(this),onReactionMouseDown:this.onReactionMouseDown.bind(this),onReactionMouseEnter:function(){},onReactionMouseLeave:function(){},shown:this.state.isShown,supportedReactions:e.supportedreactions})}.bind(this)}))):null};e.exports=a}),null);