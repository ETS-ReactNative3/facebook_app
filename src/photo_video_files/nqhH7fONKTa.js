if (self.CavalryLogger) { CavalryLogger.start_js(["gAVQ7"]); }

__d("FBStoryLiveSidePane.react",["ix","cx","fbt","Arbiter","AsyncRequest","DOMContainer.react","Image.react","Link.react","NFXStoryLocation","PopoverMenu.react","React","ReactDOM","ReactXUIMenu","Style","SubscriptionsHandler","UFIUIEvents","XRapidReportingDialogController","XUINotice.react","XUISpinner.react","fbglyph","queryThenMutateDOM"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k=b("ReactXUIMenu").Item,l=50,m=function(a){if(a.isOwnBucket)return null;var c=a.isLiveAudio?i._("Report live audio"):i._("Report live video");a=b("React").createElement(b("ReactXUIMenu"),null,b("React").createElement(k,{onclick:a.reportLiveVideo},c));return b("React").createElement(b("PopoverMenu.react"),{alignh:"right",className:"_1q41",menu:a},b("React").createElement(b("Link.react"),{href:"#","aria-label":i._("More")},b("React").createElement(b("Image.react"),{src:g("125399")})))};c=babelHelpers.inherits(a,b("React").Component);j=c&&c.prototype;function a(a){j.constructor.call(this,a),this.$7=function(a){this.$3=a}.bind(this),this.$8=function(){var a=this.props.liveVideoData;a=a&&a.media.id;a=JSON.stringify({reportable_ent_token:a,story_location:b("NFXStoryLocation").DIRECT_MESSAGING});a=b("XRapidReportingDialogController").getURIBuilder().setString("context",a).getURI();new(b("AsyncRequest"))().setURI(a).send()}.bind(this),this.$1=!1,this.$3=null,this.$4=0}a.prototype.componentDidMount=function(){this.$2=new(b("SubscriptionsHandler"))(),this.$2.addSubscriptions(b("Arbiter").subscribe(b("UFIUIEvents").Changed,function(a,b){a=this.props.uiComponents.getValue();a&&a.ufi===b.form&&this.$5()}.bind(this)),b("Arbiter").subscribe("pre_page_transition",function(){this.props.onDone()}.bind(this))),this.$1=!1,this.$5()};a.prototype.UNSAFE_componentWillReceiveProps=function(a){if((a.isSelectedBucketLiveAndEnded||!a.liveVideoData)&&this.$3){a=this.$3.getDOMChild();this.$6(a)}};a.prototype.componentWillUnmount=function(){this.$2&&this.$2.release(),this.$1=!1};a.prototype.$6=function(a){for(var c=0;c<a.children.length;c++)this.$6(a.children[c]);b("ReactDOM").unmountComponentAtNode(a)};a.prototype.$5=function(){var a=this.props.uiComponents.getValue(),c=a?a.ufiScrollableArea:null;if(!c)return;var d=0;b("queryThenMutateDOM")(function(){d=parseFloat(b("Style").get(c,"height"))},function(){var a=this.$4-(c.scrollTop+d);(!this.$1||a<l)&&(c.scrollTop=c.scrollHeight,this.$1=!0);this.$4=c.scrollHeight}.bind(this))};a.prototype.render=function(){__p&&__p();var a=this.props.liveVideoData;if(!a||this.props.isSelectedBucketLiveAndEnded)return null;var c,d=this.props.uiComponents,e=d.getValue();d.getError()?c=b("React").createElement(b("XUINotice.react"),{className:"_3-8i",use:"recommend"},i._("Something went wrong, please try again.")):e?c=b("React").createElement(b("DOMContainer.react"),null,e.topSection):c=b("React").createElement("div",{className:"_2n_f"},b("React").createElement(b("XUISpinner.react"),{size:"large"}));var f=e?b("React").createElement(b("DOMContainer.react"),{className:"_4b4k _39yn",display:"block",ref:this.$7},e.ufi):null;e=e?b("React").createElement(b("DOMContainer.react"),null,e.reactionsMenu):null;a=a.media;var g=a.height<a.width;return b("React").createElement("div",null,b("React").createElement("div",{className:this.props.isCommercialBreakRunning?"_4dlh":""}),b("React").createElement("div",{className:"_3g-3"+(g?" _6291":"")+(this.props.isCommercialBreakRunning?" _4dlk":"")},b("React").createElement("div",{className:"_4b4l"},d.getError()?null:b("React").createElement(m,{isLiveAudio:a.is_live_audio_format,isOwnBucket:this.props.isOwnBucket,reportLiveVideo:this.$8}),c,f),b("React").createElement("div",{className:"_1dbt"},b("React").createElement("div",{className:"_1dbu"},e))))};e.exports=a}),null);