if (self.CavalryLogger) { CavalryLogger.start_js(["tyQ\/5"]); }

__d("LiveVideoBroadcastRTCCallStore",["FBRTCConstants","FBRTCMultiwayMessage","FluxMapStore","LiveVideoBroadcastActions","LiveVideoBroadcastBroadcastStore","LiveVideoBroadcastConstants","LiveVideoBroadcastUIStore","LiveVideoBroadcastWaterfallEvent","LiveVideoBroadcastWaterfallTypedLogger","RTCAppDispatcher","RTCCallActionTypes","VideoBroadcastLoggerEvent","VideoBroadcastTypedLogger"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=b("FBRTCConstants").CallEndReason,i="Audio or Video Only",j="No data coming",k="Stream not published in time.";g=babelHelpers.inherits(a,b("FluxMapStore"));g&&g.prototype;a.prototype.reduce=function(a,c){__p&&__p();var d=null;switch(c.type){case b("RTCCallActionTypes").DISMISS:var e=c.request instanceof b("FBRTCMultiwayMessage")?c.request.dismissRequest():null;e=e?e.detailedReasonString:null;if(e===i||e===j){b("LiveVideoBroadcastActions").errorMWSBadAudioOrVideoData();break}else if(e===k){b("LiveVideoBroadcastActions").errorTimeOutWaitingForPublish("MWS");break}case b("RTCCallActionTypes").HANGUP:case b("RTCCallActionTypes").CALL_ERROR:case b("RTCCallActionTypes").END_CALL:switch(c.endCallReason){case h.CLIENT_ERROR:d="client_error";b("LiveVideoBroadcastActions").errorRTCClientError();break;case h.CONNECTION_DROPPED:d="connection_dropped";break;case h.SIGNALING_MESSAGE_FAILED:d="signaling_message_failed";break;case h.HANGUP_CALL:d="call_hangup";break}this.$LiveVideoBroadcastRTCCallStore1(b("VideoBroadcastLoggerEvent").FACECASTWITH_RTCCALL_ENDED,d?d:b("FBRTCConstants").callEndReasonString(c.endCallReason),c.endCallSubreason||c.detailedReasonString||null);break;case b("RTCCallActionTypes").ON_JOIN_RESPONSE:e=this.get("joinRequestSendTime");d=e?Date.now()-e:null;this.$LiveVideoBroadcastRTCCallStore2(b("LiveVideoBroadcastWaterfallEvent").UI_JOIN_RESPONSE_RECEIVED,{responseTime:d});break;case b("RTCCallActionTypes").ON_JOIN_REQUEST_SENT:a=a.set("joinRequestSendTime",Date.now());break}return a};a.prototype.$LiveVideoBroadcastRTCCallStore1=function(event,a,c){var d=b("LiveVideoBroadcastBroadcastStore").getState().toObject();d=d.broadcastId;new(b("VideoBroadcastTypedLogger"))().setOverrideVideoBroadcastID(d).setOverrideAppID(b("LiveVideoBroadcastConstants").LIVE_WWW_BROADCASTING_APP_ID).setBroadcastEvent(event).addToExtraData("broadcast_transition_reason",a).addToExtraData("broadcast_transition_subreason",c).log()};a.prototype.$LiveVideoBroadcastRTCCallStore2=function(event,a){var c=b("LiveVideoBroadcastBroadcastStore").getState().toObject(),d=c.broadcastId;c=c.videoId;var e=b("LiveVideoBroadcastBroadcastStore").getCurrentBroadcastTime();e=e===0?null:e;var f=b("LiveVideoBroadcastUIStore").getState().toObject();f=f.wasEverOffline;d=new(b("LiveVideoBroadcastWaterfallTypedLogger"))().setBroadcastID(d).setBroadcastDuration(e).setWasUserOffline(f).setVideoID(c).setEvent(event);a&&d.updateExtraData(a);d.log()};function a(){g.apply(this,arguments)}a.__moduleID=e.id;e.exports=new a(b("RTCAppDispatcher"))}),null);