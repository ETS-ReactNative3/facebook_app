if (self.CavalryLogger) { CavalryLogger.start_js(["YfA5L"]); }

__d("LiveVideoBroadcastCrosspostStore",["ActorURI","AsyncRequest","FluxMapStore","LiveVideoBroadcastBroadcastStore","LiveVideoBroadcastConstants","LiveVideoBroadcastDispatcher","XLiveVideoBroadcastRefreshCrosspostingSettingsController","immutable"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=b("LiveVideoBroadcastConstants").ACTIONS;g=babelHelpers.inherits(a,b("FluxMapStore"));g&&g.prototype;a.prototype.getInitialState=function(){return b("immutable").Map({crosspostingConfig:b("immutable").OrderedMap(),initialCrosspostingConfig:b("immutable").OrderedMap(),shouldShowCrosspostingNux:!1,showParent:null})};a.prototype.reduce=function(a,c){__p&&__p();switch(c.type){case h.UPDATE_UI_CONFIG:var d=c.values,e=d.canEditShowAndParent,f=d.shouldShowCrosspostingNux,g=d.showParent,i=c.values.crosspostingConfig;if(i!==undefined){d=b("immutable").OrderedMap().withMutations(function(a){i.forEach(function(c){return a.set(c.id,b("immutable").Map(c))});if(g){var c={id:g.pageID,name:g.name,allow:e||!1,type:"page",can_create_post:e||!1};a.set(g.pageID,b("immutable").Map(c))}});d=this.$LiveVideoBroadcastCrosspostStore1(d);a=a.set("canEditShowAndParent",e);a=a.set("crosspostingConfig",d);a=a.set("initialCrosspostingConfig",d);g&&(a=a.set("showParent",g));f!=undefined&&(a=a.set("shouldShowCrosspostingNux",f))}break;case h.SET_SHOULD_CROSSPOST_TO_PAGE:var j=c.pageId,k=c.shouldCrosspost;a=a.update("crosspostingConfig",function(a){return a.update(j,function(a){return a.set("allow",k)})});break;case h.TOGGLE_CROSSPOST_TO_SHOW_PARENT_PAGE:a=a.update("crosspostingConfig",function(b){return b.update(a.get("showParent").pageID,function(a){return a.set("allow",!a.get("allow"))})});break;case h.SET_SHOULD_CROSSPOST_TO_ALL_PAGES:var l=c.shouldCrosspost;a=a.update("crosspostingConfig",function(a){return a.map(function(a){return a.set("allow",l)})});break;case h.RESORT_CROSSPOST_CONFIGS:a=a.update("crosspostingConfig",this.$LiveVideoBroadcastCrosspostStore1);break;case h.START_BROADCAST_SUCCESS:d=this.get("crosspostingConfig");if(!d)break;f=Array.from(d.filter(function(a){return a.get("allow",!1)}).keys());a=a.set("crosspostingConfig",b("immutable").OrderedMap());new(b("AsyncRequest"))().setURI(b("ActorURI").create(b("XLiveVideoBroadcastRefreshCrosspostingSettingsController").getURIBuilder().setInt("broadcast_id",b("LiveVideoBroadcastBroadcastStore").get("broadcastId")).setFBIDVector("selected_ids",f).getURI(),b("LiveVideoBroadcastBroadcastStore").get("actorID")||"")).send();break}return a};a.prototype.$LiveVideoBroadcastCrosspostStore1=function(a){__p&&__p();return a.sort(function(a,b){__p&&__p();var c=a.get("type")==="business",d=b.get("type")==="business";if(c===d){d=a.get("allow",!1);a=b.get("allow",!1);if(d===a)return 0;else if(d)return-1;else return 1}else if(c)return-1;else return 1})};a.prototype.convertCrosspostingConfig=function(a){return Array.from(a.map(function(a){return{id:a.get("id",""),name:a.get("name",""),allow:a.get("allow",!1),type:a.get("type",""),profile_pic_uri:a.get("profile_pic_uri",null),can_create_post:a.get("can_create_post",!1)}}).values())};a.prototype.shouldShareWithOwningBusiness=function(){var a=this.get("crosspostingConfig");return a==null?!1:a.some(function(a){return a.get("allow",!1)&&a.get("type")==="business"})};a.prototype.getSelectedCrosspostPagesCount=function(){var a=this.get("crosspostingConfig");return a==null?0:a.count(function(a){return a.get("allow",!1)})};a.prototype.hasRemovedCrosspostPages=function(){var a=this.get("initialCrosspostingConfig"),c=this.get("crosspostingConfig");if(a===c)return!1;else if(a==null)return!1;else if(c==null)return!0;return a.some(function(a,d){return a.get("allow")===!0&&c.get(d,b("immutable").Map()).get("allow")===!1})};function a(){g.apply(this,arguments)}a.__moduleID=e.id;e.exports=new a(b("LiveVideoBroadcastDispatcher"))}),null);