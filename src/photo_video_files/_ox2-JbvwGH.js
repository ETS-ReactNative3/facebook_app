if (self.CavalryLogger) { CavalryLogger.start_js(["uZQrq"]); }

__d("relay-runtime/experimental/fetchQuery_UNSTABLE",["invariant","relay-runtime/experimental/getRequestKey_UNSTABLE"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=new Map(),i=new Map();function a(a){__p&&__p();var c=a.environment,d=a.query,e=a.variables,f=a.observer;a=a.networkLayerCacheConfig;var h=c.unstable_internal,i=h.createOperationSelector;h=h.getRequest;h=h(d);h.operationKind==="query"||g(0,undefined);var n=j(c),o=k(c),p=i(h,e),q=b("relay-runtime/experimental/getRequestKey_UNSTABLE")(h,e);d=n.get(q);h=o.get(q);h?o.set(q,babelHelpers["extends"]({},h,{count:h.count+1})):o.set(q,{references:[],count:1});if(d){e=f&&!d.observers.find(function(a){return a===f})?[].concat(d.observers,[f]):d.observers;f&&d.receivedEvents.forEach(function(a){var b=a.data;a=f[a.event];b!==undefined?a&&a(b):a&&a()});n.set(q,babelHelpers["extends"]({},d,{observers:e}))}else c.execute({operation:p,cacheConfig:a}).map(function(a){var b=i(p.node,a.variables,a.operation),d=o.get(q);d!=null||g(0,undefined);d.references.push(c.retain(b.root));return a})["finally"](function(){n["delete"](q)}).subscribe({start:function(a){n.set(q,{subscription:a,observers:f?[f]:[],receivedEvents:[]}),m(n,q,{event:"start",data:a}),l(n,q).forEach(function(b){return b.start&&b.start(a)})},next:function(a){m(n,q,{event:"next",data:a}),l(n,q).forEach(function(b){return b.next&&b.next(a)})},error:function(a){m(n,q,{event:"error",data:a}),l(n,q).forEach(function(b){return b.error&&b.error(a)})},complete:function(){m(n,q,{event:"complete"}),l(n,q).forEach(function(a){return a.complete&&a.complete()})},unsubscribe:function(a){m(n,q,{event:"unsubscribe",data:a}),l(n,q).forEach(function(b){return b.unsubscribe&&b.unsubscribe(a)})}});return{dispose:function(){__p&&__p();var a=o.get(q);a!=null||g(0,undefined);var b=a.count;a=a.references;if(b===1){a.forEach(function(a){return a.dispose()});o["delete"](q);var c=n.get(q);c&&c.subscription.unsubscribe()}else o.set(q,{references:a,count:Math.max(0,b-1)})}}}function j(a){var b=h.get(a);if(b!=null)return b;b=new Map();h.set(a,b);return b}function k(a){var b=i.get(a);if(b!=null)return b;b=new Map();i.set(a,b);return b}function l(a,b){a=a.get(b);a!=null||g(0,undefined);return a.observers}function m(a,b,c){var d=a.get(b);d!=null||g(0,undefined);c=[].concat(d.receivedEvents,[c]);a.set(b,babelHelpers["extends"]({},d,{receivedEvents:c}))}e.exports=a}),null);