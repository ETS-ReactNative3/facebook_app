if (self.CavalryLogger) { CavalryLogger.start_js(["1xCVd"]); }

__d("ReactComposerLiveEncoderSelector.react",["fbt","React","XUISingleSelector.react","promiseDone","GraphAPI","XLiveVideoBroadcastStatusController","AsyncRequest"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i=b("XUISingleSelector.react").Option;c=babelHelpers.inherits(a,b("React").Component);h=c&&c.prototype;function a(a){__p&&__p();h.constructor.call(this,a);this.$1=function(a){if(a.value){if(this.props.broadcastID){this.$2(a.value,this.props.broadcastID);return}var c=b("XLiveVideoBroadcastStatusController").getURIBuilder().setFBID("video_id",this.props.videoID).getURI();new(b("AsyncRequest"))(c).setHandler(function(b){b.payload.broadcast_id&&this.$2(a.value,b.payload.broadcast_id)}.bind(this)).send()}}.bind(this);var c=a.encoders?a.encoders:[];this.state={liveEncoderOptions:c,selected:a.defaultEncoder}}a.prototype.UNSAFE_componentWillMount=function(){if(this.props.encoders)return;b("promiseDone")(b("GraphAPI")("2.8").object("user",this.props.targetID).edge("live_encoders").get({access_token:this.props.accessToken,fields:["id","name"]}).then(function(a){this.setState({liveEncoderOptions:a.data})}.bind(this)))};a.prototype.render=function(){return b("React").createElement("div",{"data-testid":"live-encoder-selector"},b("React").createElement(b("XUISingleSelector.react"),{value:this.state.selected,onChange:this.$1},b("React").createElement(i,{value:null},g._("None")),this.state.liveEncoderOptions.map(function(a){return b("React").createElement(i,{value:a.id,key:a.id},a.name)})))};a.prototype.$2=function(a,c){b("promiseDone")(b("GraphAPI")("2.8").object("live_video",c).post({access_token:this.props.accessToken,live_encoders:[a]}),function(b){this.setState({selected:a}),this.props.onSelectEncoder&&this.props.onSelectEncoder(a)}.bind(this))};e.exports=a}),null);